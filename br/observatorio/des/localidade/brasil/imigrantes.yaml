# ========================================================
principais:
  - relevance: 'lead' 
    cls: 'xs12'
    rowClass: "pt-0 px-3 pb-5"
    api:
      fixed: "/indicadoresnacionais?categorias=cd_indicador,nu_competencia,ds_fonte&valor=vl_indicador&agregacao=SUM&filtros=eq-cd_indicador-'MIGRA_ATIVOS',and,eq-nu_competencia-nu_competencia_max"
    args:
      - prop: "value"
        named_prop: 'agr_sum_vl_indicador'
        format: 'inteiro'
        collapse:
          format: 'real'
        default: "Nenhum"
      - prop: "description"
        fixed: "Trabalhadores migrantes de outras nacionalidades Ativos no Mercado de Trabalho Formal"
      - prop: 'comment'
        template: "({0}, {1})"
        args:
          - named_prop: "ds_fonte"
          - named_prop: "nu_competencia"
  - relevance: 'lead' 
    cls: 'xs12'
    rowClass: "pt-0 px-3 pb-5"
    api:
      template: "/indicadoresnacionais?categorias=cd_indicador,ds_fonte,nu_competencia,vl_indicador&filtros=eq-cd_indicador-'MIGRA_ATIVOS_REM_MEDIA_AGREG',and,eq-nu_competencia-nu_competencia_max"
      args:
        - named_prop: "idLocalidade"
    args:
      - prop: "value"
        named_prop: 'vl_indicador'
        format: 'monetario'
        collapse:
          format: 'monetario'
        default: "Nenhum"
      - prop: "description"
        fixed: "Remuneração Média dos trabalhadores migrantes de outras nacionalidades no país"
      - prop: 'comment'
        template: "({0}, {1})"
        args:
          - named_prop: "ds_fonte"
          - named_prop: "nu_competencia"

# ========================================================
secoes:
  - id: "imigrantes_unico"
    name: ""
    cards:
# ====================================================  
      - id: "card_fluxos_migratorios"
        title: 
          fixed: "Fluxos Migratórios Internacionais"
        description:
          - type: "minicards"
            cards:
              - relevance: 'high' 
                cls: 'xs12 sm6'
                rowClass: "pt-0 px-3 pb-5"
                api:
                  fixed: "/indicadoresestaduais?categorias=cd_uf,nm_uf,nu_competencia&valor=vl_indicador&agregacao=SUM&ordenacao=-agr_sum_vl_indicador&filtros=eq-cd_indicador-'FLUXOS_MIGRATORIOS_INTERNAC',and,ge-nu_competencia-nu_competencia_max&limit=1"
                args:
                  - prop: "value"
                    named_prop: 'nm_uf'
                    default: "-"
                  - prop: "description"
                    fixed: "UF com maior número de migrantes de outras nacionalidades contratados"
                  - prop: "comment"
                    named_prop: "nu_competencia"
                    default: ""
              - relevance: 'high' 
                cls: 'xs12 sm6'
                rowClass: "pt-0 px-3 pb-5"
                api:
                  fixed: "/indicadoresestaduais?categorias=ds_agreg_secundaria,nu_competencia&valor=vl_indicador&agregacao=SUM&ordenacao=-agr_sum_vl_indicador&filtros=eq-cd_indicador-'FLUXOS_MIGRATORIOS_INTERNAC',and,ge-nu_competencia-nu_competencia_max&limit=1"
                args:
                  - prop: "value"
                    named_prop: 'ds_agreg_secundaria'
                    default: "-"
                  - prop: "description"
                    fixed: "Origem do maior número de migrantes de outras nacionalidades contratados<br/>"
                  - prop: "comment"
                    named_prop: "nu_competencia"
                    default: ""

          - type: "text"
            title: ""
            content:
              template: "Em destaque, a UF em que o maior número de migrantes de outras nacionalidades foi contratado no ano de {0}, bem como a nacionalidade mais contratada. No diagrama ao lado, apresentam-se os possíveis fluxos migratórios internacionais associados. É importante observar que a migração pode haver ocorrido com outras etapas antecedentes. Os dados processados consideram apenas a origem do migrante de outra nacionalidade e a Unidade Federativa em que ele foi contratado."
              api:
                fixed: "/indicadoresestaduais?categorias=nu_competencia_min,nu_competencia_max&limit=1&filtros=eq-cd_indicador-'FLUXOS_MIGRATORIOS_INTERNAC'"
              args:
                - named_prop: "nu_competencia_max"
          - id: "select_origem"
            type: "select"
            label: "Origem/Continente"
            default:
              fixed: "América do Sul ou Central"
            api:
              fixed: "/indicadoresestaduais?categorias=ds_agreg_primaria&agregacao=distinct&ordenacao=ds_agreg_primaria&filtros=eq-cd_indicador-'FLUXOS_MIGRATORIOS_INTERNAC'"
            args:
              - prop: "id"
                named_prop: "ds_agreg_primaria"
              - prop: "label"
                named_prop: "ds_agreg_primaria"
                null_value: "(Não informado)"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-ds_agreg_primaria-'{0}'"
                api:
                  args:
                    - named_prop: "ds_agreg_primaria"

          - id: "select_uf"
            type: "select"
            label: "Unidade Federativa"
            api:
              fixed: "/municipios?categorias=cd_uf,nm_uf&agregacao=distinct&ordenacao=nm_uf&filtros=eq-1-1"
            args:
              - prop: "id"
                named_prop: "cd_uf"
              - prop: "label"
                named_prop: "nm_uf"
            selection:
              event: "selection"
              rules:
               filter: ",and,eq-cd_uf-{0}"
               api:
                 args:
                   - named_prop: "cd_uf"

          - type: "slider"
            cls: "pl-2"
            id: "slider_periodo"
            default: 2019
            title: ""
            api:
              fixed: "/indicadoresestaduais?categorias=nu_competencia_min,nu_competencia_max&limit=1&filtros=eq-cd_indicador-'FLUXOS_MIGRATORIOS_INTERNAC'"
            args:
              - prop: "min"
                named_prop: "nu_competencia_min"
              - prop: "max"
                named_prop: "nu_competencia_max"
            selection:
              event: "selection"
              rules:
                filter: ",and,eq-nu_competencia-'{0}'"
                api:
                  args:
                    - named_prop: "value"


        chart_type: "SANKEYD3"
        api: 
          fixed: "/indicadoresestaduais?categorias=ds_agreg_secundaria,nm_uf,vl_indicador&ordenacao=-vl_indicador&filtros=eq-cd_indicador-'FLUXOS_MIGRATORIOS_INTERNAC',and,eq-nu_competencia-nu_competencia_max,and,eq-ds_agreg_primaria-'América do Sul ou Central'"
        apiBase: 
          fixed: "/indicadoresestaduais?categorias=ds_agreg_secundaria,nm_uf,vl_indicador&ordenacao=-vl_indicador&filtros=eq-cd_indicador-'FLUXOS_MIGRATORIOS_INTERNAC'"
        headers:
          - text: 'Origem'
            align: 'left'
            value: 'ds_agreg_secundaria'
          - text: 'Destino'
            align: 'left'
            value: 'nm_uf'
          - text: 'Total'
            align: 'left'
            value: 'vl_indicador'
        chart_options:
          id_field: 'id'
          source_field: 'ds_agreg_secundaria'
          target_field: 'nm_uf'
          value_field: 'vl_indicador'
# ========================================================
      - id: "line_evolucao_origem"
        title: 
          fixed: "Evolução da Presença de Outras Nacionalidades no Mercado de Trabalho Formal"
        title_comment:
          template: "{0}, de {1} a {2}"
          api:
            fixed: "/indicadoresnacionais?categorias=nu_competencia_max,nu_competencia_min&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
            - named_prop: "nu_competencia_min"
            - named_prop: "nu_competencia_max"
        description:
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12 md6'
                api:
                  fixed: "/indicadoresnacionais?categorias=cd_indicador&valor=vl_indicador&agregacao=SUM&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
                args:
                  - prop: "value"
                    named_prop: 'agr_sum_vl_indicador'
                    format: 'inteiro'
                    collapse:
                      format: 'real'
                    default: "Nenhum"
                  - prop: "description"
                    fixed: "Trabalhadores migrantes de outras nacionalidades Admitidos no Mercado de Trabalho Formal"
          - type: "text"
            title: ""
            content:
              template: "Em destaque, para a unidade geográfica em realce, o número de trabalhadores migrantes de outras nacionalidades admitidos no mercado de trabalho formal brasileiro de {0} a {1}. No gráfico, apresenta-se a evolução histórica da presença desses migrantes por continente de origem. As informações são baseadas em dados oficiais da Relação Anual de Informações Sociais (RAIS) de {1} (a mais atual disponível). A RAIS de cada ano é divulgada no ano seguinte em relação aos dados do ano anterior. No caso, portanto, a situação corresponde ao cenário com o qual se iniciou o ano de {2}."
              api:
                fixed: "/indicadoresnacionais?categorias=nu_competencia_max,nu_competencia_min&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
                options:
                  calcs:
                    - id: "proximo_ano"
                      function: "calc_addition_ids_ds"
                      fn_args:
                        - named_prop: "nu_competencia_max"
                        - fixed: 1
                        - fixed: 1
              args:
                - named_prop: "nu_competencia_min"
                - named_prop: "nu_competencia_max"
                - named_prop: "calc_proximo_ano"
        chart_type: "LINE"
        footnote: "Evolução da Presença de Outras Nacionalidades no Mercado de Trabalho Formal por Continente de Origem"
        api: 
          fixed: "/indicadoresnacionais?categorias=ds_agreg_primaria,ds_indicador_completo,nu_competencia,cd_indicador,ds_fonte&valor=vl_indicador&agregacao=SUM&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
          options:
            formatters:
              - id: "agr_sum_vl_indicador"
                format: 'inteiro'
        headers:
          - text: 'Origem'
            align: 'left'
            value: 'ds_agreg_primaria'
          - text: 'Indicador'
            align: 'left'
            value: 'ds_indicador_completo'
          - text: 'Ano'
            align: 'left'
            value: 'nu_competencia'
          - text: 'Qtde'
            value: 'fmt_agr_sum_vl_indicador'
        chart_options:
          id: "ds_agreg_primaria"
          x: "nu_competencia"
          y: "agr_sum_vl_indicador"
          text: "fmt_agr_sum_vl_indicador"
        source:
          desc_field: "ds_fonte"
# ====================================================          
      - id: "line_evolucao_origem_pais"
        title: 
          fixed: "Evolução da Presença de Migrantes da América Central e do Sul no Mercado de Trabalho Formal"
        title_comment:
          template: "{0}, de 2000 a {1}"
          api:
            fixed: "/indicadoresnacionais?categorias=nu_competencia_max,nu_competencia_min&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS_PAIS'"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
            - named_prop: "nu_competencia_max"
        description:
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12 md6'
                api:
                  fixed: "/indicadoresnacionais?categorias=cd_indicador&valor=vl_indicador&agregacao=SUM&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS_PAIS',and,in-ds_agreg_primaria-'Argentina'-'Bolívia'-'Chile'-'Equador'-'Haiti'-'Paraguai'-'Peru'-'Uruguai'-'Venezuela'-'Outros Países Latino Americanos',and,ge-nu_competencia-'2000'"
                args:
                  - prop: "value"
                    named_prop: 'agr_sum_vl_indicador'
                    format: 'inteiro'
                    collapse:
                      format: 'real'
                    default: "Nenhum"
                  - prop: "description"
                    fixed: "Trabalhadores migrantes de outras nacionalidades da América Central e do Sul Admitidos no Mercado de Trabalho Formal"
          - type: "text"
            title: ""
            content:
              template: "Em destaque, para a unidade geográfica em realce, o número de trabalhadores migrantes da América Central e do Sul admitidos no mercado de trabalho formal brasileiro de 2000 a {0}. No gráfico, apresenta-se a evolução histórica da presença desses migrantes por país de origem. As informações são baseadas em dados oficiais da Relação Anual de Informações Sociais (RAIS) de {0} (a mais atual disponível). A RAIS de cada ano é divulgada no ano seguinte em relação aos dados do ano anterior. No caso, portanto, a situação corresponde ao cenário com o qual se iniciou o ano de {1}."
              api:
                fixed: "/indicadoresnacionais?categorias=nu_competencia_max,nu_competencia_min&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
                options:
                  calcs:
                    - id: "proximo_ano"
                      function: "calc_addition_ids_ds"
                      fn_args:
                        - named_prop: "nu_competencia_max"
                        - fixed: 1
                        - fixed: 1
              args:
                - named_prop: "nu_competencia_max"
                - named_prop: "calc_proximo_ano"
        chart_type: "LINE"
        api: 
          fixed: "/indicadoresnacionais?categorias=ds_agreg_primaria,ds_indicador_completo,nu_competencia,cd_indicador,ds_fonte&valor=vl_indicador&agregacao=SUM&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS_PAIS',and,in-ds_agreg_primaria-'Argentina'-'Bolívia'-'Chile'-'Equador'-'Haiti'-'Paraguai'-'Peru'-'Uruguai'-'Venezuela'-'Outros Países Latino Americanos',and,ge-nu_competencia-'2000'"
          options:
            formatters:
              - id: "agr_sum_vl_indicador"
                format: 'inteiro'
        headers:
          - text: 'Origem'
            align: 'left'
            value: 'ds_agreg_primaria'
          - text: 'Indicador'
            align: 'left'
            value: 'ds_indicador_completo'
          - text: 'Ano'
            align: 'left'
            value: 'nu_competencia'
          - text: 'Qtde'
            value: 'fmt_agr_sum_vl_indicador'
        chart_options:
          id: "ds_agreg_primaria"
          x: "nu_competencia"
          y: "agr_sum_vl_indicador"
          text: "fmt_agr_sum_vl_indicador"
        source:
          desc_field: "ds_fonte"
# ========================================================
      - id: "treemap_origem_imigrantes"
        title:
          fixed: "Migrantes de Outras Nacionalidades no Mercado de Trabalho Formal por Origem"
        title_comment:
          template: "{0}, {1}"
          api:
            fixed: "/indicadoresnacionais?categorias=nu_competencia_max&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS'"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
            - named_prop: "nu_competencia_max"
        # info:
        #   - type: "text"
        #     title: "Sobre a métrica"
        #     content:
        #       fixed: ""
        description: 
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12 md7'
                api:
                  fixed: "/indicadoresnacionais?categorias=cd_indicador&valor=vl_indicador&agregacao=SUM&filtros=eq-cd_indicador-'MIGRA_ATIVOS',and,eq-nu_competencia-nu_competencia_max"
                args:
                  - prop: "value"
                    named_prop: 'agr_sum_vl_indicador'
                    format: 'inteiro'
                    collapse:
                      format: 'real'
                    default: "Nenhum"
                  - prop: "description"
                    fixed: "Trabalhadores migrantes de outras nacionalidades Ativos no Mercado de Trabalho Formal"

          - type: "text"
            title: ""
            content:
              template: "Em destaque, o número de migrantes de outras nacionalidades ativos no mercado de trabalho formal na Unidade Federativa selecionada, incluindo vínculos com carteira assinada (CLT) e administrativos ou estatutários. No gráfico ao lado, comparam-se os totais para os continentes de origem dos trabalhadores. As informações são baseadas em dados oficiais da Relação Anual de Informações Sociais (RAIS) de {0} (a mais atual disponível). A RAIS de cada ano é divulgada no ano seguinte em relação aos dados do ano anterior. No caso, portanto, a situação corresponde ao cenário com o qual se iniciou o ano de {1}."
              api:
                fixed: "/indicadoresnacionais?categorias=nu_competencia_max&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS'"
                options:
                  calcs:
                    - id: "proximo_ano"
                      function: "calc_addition_ids_ds"
                      fn_args:
                        - named_prop: "nu_competencia_max"
                        - fixed: 1
                        - fixed: 1
              args:
                - named_prop: "nu_competencia_max"
                - named_prop: "calc_proximo_ano"

        chart_type: "TREEMAP"
        preloaded:
          prop: "centralindicadores"
          function: "slice"
          id: ['MIGRA_ATIVOS']
          year: "max"
          options:
            formatters:
              - id: "vl_indicador"
                format: 'inteiro'
        headers:
          - text: 'Origem'
            align: 'left'
            value: 'ds_agreg_primaria'
          - text: 'Indicador'
            align: 'left'
            value: 'ds_indicador_completo'
          - text: 'Ano'
            align: 'left'
            value: 'nu_competencia'
          # - text: 'Qtde'
          #   value: 'vl_indicador'
          - text: 'Qtde'
            value: 'vl_indicador_txt'
        chart_options:
          id: "ds_agreg_primaria"
          text: "ds_agreg_primaria"
          size: "vl_indicador"
          colorScale:
            name: "BuGn"
            type: "singleHue"
            levels: 6
            order: 'asc'
        source:
          desc_field: "ds_fonte"
# ========================================================
      - id: "treemap_presenca_imigrantes"
        title:
          fixed: "Presença de migrantes de outras nacionalidades no Mercado de Trabalho formal"
        title_comment:
          template: "{0}, {1}"
          api:
            fixed: "/indicadoresnacionais?categorias=nu_competencia_max&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS'"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
            - named_prop: "nu_competencia_max"
        # info:
        #   - type: "text"
        #     title: "Sobre a métrica"
        #     content:
        #       fixed: ""
        description: 
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12 md7'
                api:
                  fixed: "/indicadoresnacionais?categorias=cd_indicador&valor=vl_indicador&agregacao=SUM&filtros=eq-cd_indicador-'MIGRA_ATIVOS',and,eq-nu_competencia-nu_competencia_max"
                args:
                  - prop: "value"
                    named_prop: 'agr_sum_vl_indicador'
                    format: 'inteiro'
                    collapse:
                      format: 'real'
                    default: "Nenhum"
                  - prop: "description"
                    fixed: "Trabalhadores migrantes de outras nacionalidades Ativos no Mercado de Trabalho Formal"

          - type: "text"
            title: ""
            content:
              template: "Em destaque, o número de trabalhadores estrangeiro ativos no mercado de trabalho formal no país, incluindo vínculos com carteira assinada (CLT) e administrativos ou estatutários. No gráfico, comparam-se os totais de trabalhadores estrageiros nas Unidades Federativas. As informações são baseadas em dados oficiais da Relação Anual de Informações Sociais (RAIS) de {0} (a mais atual disponível). A RAIS de cada ano é divulgada no ano seguinte em relação aos dados do ano anterior. No caso, portanto, a situação corresponde ao cenário com o qual se iniciou o ano de {1}."
              api:
                fixed: "/indicadoresnacionais?categorias=nu_competencia_max&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS'"
                options:
                  calcs:
                    - id: "proximo_ano"
                      function: "calc_addition_ids_ds"
                      fn_args:
                        - named_prop: "nu_competencia_max"
                        - fixed: 1
                        - fixed: 1
              args:
                - named_prop: "nu_competencia_max"
                - named_prop: "calc_proximo_ano"
          - id: "select_origem"
            type: "select"
            label: "Origem/Continente"
            api:
              fixed: "/indicadoresnacionais?categorias=ds_agreg_primaria&agregacao=distinct&ordenacao=ds_agreg_primaria&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
            args:
              - prop: "id"
                named_prop: "ds_agreg_primaria"
              - prop: "label"
                named_prop: "ds_agreg_primaria"
                null_value: "(Não informado)"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-ds_agreg_primaria-'{0}'"
                api:
                  args:
                    - named_prop: "ds_agreg_primaria"

        chart_type: "TREEMAP"
        api:
          fixed: "/indicadoresestaduais?categorias=cd_indicador,cd_uf,sg_uf,nm_uf,ds_indicador_completo,ds_fonte,nu_competencia&valor=vl_indicador&agregacao=SUM&filtros=eq-cd_indicador-'MIGRA_ATIVOS',and,eq-nu_competencia-nu_competencia_max,and,nn-cd_uf"
          options:
            calcs:
              - id: "faixa"
                function: "get_bin"
                fn_args:
                  - named_prop: "agr_sum_vl_indicador"
                  - fixed: [10,50,100,500,1000,2000,5000,10000,20000,40000]
            formatters:
              - id: "agr_sum_vl_indicador"
                format: 'inteiro'
        headers:
          - text: 'Unidade Federativa'
            align: 'left'
            value: 'nm_uf'
          - text: 'Indicador'
            align: 'left'
            value: 'ds_indicador_completo'
          - text: 'Ano'
            align: 'left'
            value: 'nu_competencia'
          # - text: 'Qtde'
          #   value: 'fmt_agr_sum_vl_indicador'
          - text: 'Qtde'
            value: 'calc_faixa'
        chart_options:
          id: "cd_uf"
          text: "nm_uf"
          size: "agr_sum_vl_indicador"
          colorScale:
            name: "BuGn"
            type: "singleHue"
            levels: 6
            order: 'asc'
        source:
          desc_field: "ds_fonte"
# ========================================================
      - id: "bar_remuneracao_trabalhadores_continente"
        title: 
          fixed: "Remuneração de Trabalhadores migrantes de outras nacionalidades por Origem"
        title_comment:
          template: "{0}, em {1}"
          api:
            fixed: "/indicadoresnacionais?categorias=nu_competencia_max&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_REM_MEDIA'"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
            - named_prop: "nu_competencia_max"
        info:
          - type: "text"
            title: "Sobre a métrica"
            content:
              fixed: "Sem observações adicionais. Vide descrição."
        description:
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12'
                api:
                  fixed: "/indicadoresnacionais?categorias=vl_indicador,vl_indicador_txt,ds_agreg_primaria&filtros=eq-cd_indicador-'MIGRA_ATIVOS_REM_MEDIA',and,eq-nu_competencia-nu_competencia_max&ordenacao=-vl_indicador&limit=1"
                args:
                  - prop: "value"
                    named_prop: 'ds_agreg_primaria'
                    default: "Nenhum"
                  - prop: "description"
                    fixed: "Origem dos Trabalhadores com maior remuneração média"
                  - prop: "comment"
                    named_prop: 'vl_indicador_txt'
                    default: "-"

              - relevance: 'high'
                cls: 'xs12'
                api:
                  fixed: "/indicadoresnacionais?categorias=vl_indicador,vl_indicador_txt,ds_agreg_primaria&filtros=eq-cd_indicador-'MIGRA_ATIVOS_REM_MEDIA',and,eq-nu_competencia-nu_competencia_max&ordenacao=vl_indicador&limit=1"
                args:
                  - prop: "value"
                    named_prop: 'ds_agreg_primaria'
                    default: "Nenhum"
                  - prop: "description"
                    fixed: "Origem dos Trabalhadores com menor remuneração média"
                  - prop: "comment"
                    named_prop: 'vl_indicador_txt'
                    default: "-"

          - type: "text"
            title: ""
            content:
              template: "Em destaque, a origem dos trabalhadores de maior e menor remuneração média, incluindo vínculos com carteira assinada (CLT) e administrativos ou estatutários. No gráfico, comparam-se os valores para as origens dos trabalhadores. As informações são baseadas em dados oficiais da Relação Anual de Informações Sociais (RAIS) de {0} (a mais atual disponível). A RAIS de cada ano é divulgada no ano seguinte em relação aos dados do ano anterior. No caso, portanto, a situação corresponde ao cenário com o qual se iniciou o ano de {1}."
              api:
                fixed: "/indicadoresnacionais?categorias=nu_competencia_max&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_REM_MEDIA'"
                options:
                  calcs:
                    - id: "proximo_ano"
                      function: "calc_addition_ids_ds"
                      fn_args:
                        - named_prop: "nu_competencia_max"
                        - fixed: 1
                        - fixed: 1
              args:
                - named_prop: "nu_competencia_max"
                - named_prop: "calc_proximo_ano"
              
        chart_type: "BAR"
        api:
          fixed: "/indicadoresnacionais?categorias=vl_indicador,vl_indicador_txt,ds_agreg_primaria,ds_indicador_completo,nu_competencia,ds_fonte&filtros=eq-cd_indicador-'MIGRA_ATIVOS_REM_MEDIA',and,eq-nu_competencia-nu_competencia_max&ordenacao=-vl_indicador"
          options:
            calcs:
              - id: "bar_description"
                function: "applyInterpolReplaceDatasetParam"
                fn_args:
                  - fixed: 
                      template: "{0} - {1}"
                      args:
                        - named_prop: "ds_agreg_primaria"
                        - named_prop: "vl_indicador_txt"
        headers:
          - text: 'Origem'
            align: 'left'
            value: 'ds_agreg_primaria'
          - text: 'Indicador'
            align: 'left'
            value: 'ds_indicador_completo'
          - text: 'Ano'
            align: 'left'
            value: 'nu_competencia'
          - text: 'Remuneração Média'
            value: 'vl_indicador_txt'
          # - text: 'Remuneração Média (R$)'
          #   value: 'vl_indicador'
          #   format: "monetario"
        chart_options:
          id: "ds_agreg_primaria"
          y: "ds_agreg_primaria"
          x: "vl_indicador"
          # orientation: "vertical"
          text: "calc_bar_description"
          show_x_axis: false
          show_y_axis: false
          hide_legend: true
          order_field: "vl_indicador"
          color: "#238B45"
          # colorScale:
          #   name: "Greens"
          #   type: "singleHue"
          #   levels: 7
        source:
          desc_field: "ds_fonte"

# ========================================================
      - id: "mapa_imigrantes_remuneracao"
        title: 
          fixed: "Distribuição Geográfica das Remunerações Médias de Trabalhadores migrantes de outras nacionalidades"
        title_comment:
          template: "{0}, {1}"
          api:
            fixed: "/indicadoresnacionais?categorias=nu_competencia_max,nu_competencia_min&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_REM_MEDIA_AGREG'"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
            - named_prop: "nu_competencia_max"
        # info:
        #   - type: "text"
        #     title: "Sobre a métrica"
        #     content:
        #       fixed: "O total de resgates foi calculado com base em informações extraídas do Banco de Dados COETE (Ministério do Trabalho), que inclui beneficiários e não-beneficiários do Seguro-Desemprego modalidade trabalhador resgatado."
        msgNoData:
          desc: "No período, não houve trabalhadores migrantes de outras nacionalidades admitidos no mercado de trabalho formal."
        description:
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12'
                api:
                  fixed: "/indicadoresnacionais?categorias=cd_indicador,ds_fonte,nu_competencia,vl_indicador&filtros=eq-cd_indicador-'MIGRA_ATIVOS_REM_MEDIA_AGREG',and,eq-nu_competencia-nu_competencia_max"
                args:
                  - prop: "value"
                    named_prop: 'vl_indicador'
                    format: 'monetario'
                    collapse:
                      format: 'monetario'
                    default: "Nenhum"
                  - prop: "description"
                    fixed: "Remuneração Média no Brasil"
          - type: "text"
            title: ""
            content:
              template: "Em destaque, a remuneração média dos trabalhadores migrantes de outras nacionalidades, incluindo vínculos com carteira assinada (CLT) e administrativos ou estatutários. No mapa, comparam-se as diferentes unidades federativas quanto à remuneração média dos trabalhadores migrantes de outras nacionalidades. A escala de cores varia do branco (menor quantidade) para o azul escuro (maior quantidade). As informações são baseadas em dados oficiais da Relação Anual de Informações Sociais (RAIS) de {0} (a mais atual disponível). A RAIS de cada ano é divulgada no ano seguinte em relação aos dados do ano anterior. No caso, portanto, a situação corresponde ao cenário com o qual se iniciou o ano de {1}."
              api:
                fixed: "/indicadoresnacionais?categorias=nu_competencia_max&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_REM_MEDIA'"
                options:
                  calcs:
                    - id: "proximo_ano"
                      function: "calc_addition_ids_ds"
                      fn_args:
                        - named_prop: "nu_competencia_max"
                        - fixed: 1
                        - fixed: 1
              args:
                - named_prop: "nu_competencia_max"
                  required: true
                - named_prop: "calc_proximo_ano"
          - id: "select_origem"
            type: "select"
            label: "Origem/Continente"
            api:
              fixed: "/indicadoresnacionais?categorias=ds_agreg_primaria&agregacao=distinct&ordenacao=ds_agreg_primaria&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
            args:
              - prop: "id"
                named_prop: "ds_agreg_primaria"
              - prop: "label"
                named_prop: "ds_agreg_primaria"
                null_value: "(Não informado)"
            selection:
              event: "selection" 
              rules:
                api:
                  template: "/indicadoresestaduais?categorias=cd_uf,nm_uf,ds_fonte,vl_indicador,vl_indicador_txt,ds_agreg_primaria&filtros=eq-cd_indicador-'MIGRA_ATIVOS_REM_MEDIA',and,eq-nu_competencia-nu_competencia_max,and,nn-cd_uf,and,eq-ds_agreg_primaria-'{0}'"
                  args:
                    - named_prop: "ds_agreg_primaria"
        chart_type: "MAP_TOPOJSON"
        api:
          template: "/indicadoresestaduais?categorias=cd_uf,nm_uf,ds_fonte,vl_indicador,vl_indicador_txt,'Todas'-ds_agreg_primaria&filtros=eq-cd_indicador-'MIGRA_ATIVOS_REM_MEDIA_AGREG',and,eq-nu_competencia-nu_competencia_max,and,nn-cd_uf"
          args:
            - named_prop: "cd_uf"
          options:
            calcs:
              - id: "deviation"
                function: "get_log"
            formatters:
              - id: "vl_indicador"
                format: 'monetario'
        headers:
          - text: 'Unidade Federativa'
            align: 'left'
            value: 'nm_uf'
          - text: 'Origem'
            align: 'left'
            value: 'ds_agreg_primaria'
          - text: 'Remuneração Média'
            value: 'vl_indicador_txt'
          # - text: 'Remuneração Média (R$)'
          #   value: 'fmt_vl_indicador'
        chart_options:
          id_field: 'cd_uf'
          topo_key: "codigo"
          value_field: 'calc_deviation'
          colorScale:
            name: 'Reds'
            order: 'desc'
        source:
          desc_field: "ds_fonte"
## ========================================================
      - id: "mapa_imigrantes_admitidos"
        title: 
          fixed: "Distribuição Geográfica de Contratações de Trabalhadores migrantes de outras nacionalidades"
        title_comment:
          template: "{0}, de {1} a {2}"
          api:
            fixed: "/indicadoresnacionais?categorias=nu_competencia_max,nu_competencia_min&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
            - fixed: "2015"
            - named_prop: "nu_competencia_max"
        # info:
        #   - type: "text"
        #     title: "Sobre a métrica"
        #     content:
        #       fixed: "O total de resgates foi calculado com base em informações extraídas do Banco de Dados COETE (Ministério do Trabalho), que inclui beneficiários e não-beneficiários do Seguro-Desemprego modalidade trabalhador resgatado."
        msgNoData:
          desc: "No período, não houve trabalhadores migrantes de outras nacionalidades admitidos no mercado de trabalho formal."
        description:
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12 md6'
                api:
                  fixed: "/indicadoresnacionais?categorias=cd_indicador&valor=vl_indicador&agregacao=SUM&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS',and,ge-nu_competencia-'2015'"
                args:
                  - prop: "value"
                    named_prop: 'agr_sum_vl_indicador'
                    format: 'inteiro'
                    collapse:
                      format: 'real'
                    default: "Nenhum"
                  - prop: "description"
                    fixed: "Trabalhadores migrantes de outras nacionalidades Admitidos no Mercado de Trabalho Formal"
          - type: "text"
            title: ""
            content:
              template: "Em destaque, o número de trabalhadores migrantes de outras nacionalidades admitidos no mercado de trabalho formal de 2015 a {0}. No mapa, as diferentes unidades federativas podem ser comparadas. A escala de cores varia do branco (menor quantidade) para o vermelho (maior quantidade)."
              preloaded:
                prop: "centralindicadores"
                function: "slice"
                id: ['MIGRA_ATIVOS_CONTRATADOS']
              args:
                - named_prop: "nu_competencia_max"
                  required: true
          - type: "slider"
            cls: "pl-2"
            id: "slider_periodo"
            range: true
            title: ""
            api:
              fixed: "/indicadoresnacionais?categorias=nu_competencia_max&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
            args:
              - prop: "min"
                fixed: "2015"
              - prop: "max"
                named_prop: "nu_competencia_max"
            selection:
              event: "selection"
              rules:
                filter: ",and,ge-nu_competencia-'{0}',and,le-nu_competencia-'{1}'"
                api:
                  args:
                    - named_prop: "value_min"
                    - named_prop: "value_max"
          - id: "select_origem"
            type: "select"
            label: "Origem/Continente"
            api:
              fixed: "/indicadoresnacionais?categorias=ds_agreg_primaria&agregacao=distinct&ordenacao=ds_agreg_primaria&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
            args:
              - prop: "id"
                named_prop: "ds_agreg_primaria"
              - prop: "label"
                named_prop: "ds_agreg_primaria"
                null_value: "(Não informado)"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-ds_agreg_primaria-'{0}'"
                api:
                  args:
                    - named_prop: "ds_agreg_primaria"
        chart_type: "MAP_TOPOJSON"
        api:
          template: "/indicadoresestaduais?categorias=cd_uf,nm_uf,ds_fonte&valor=vl_indicador&agregacao=SUM&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS',and,ge-nu_competencia-'2015',and,nn-cd_uf"
          args:
            - named_prop: "cd_uf"
          options:
            calcs:
              - id: "faixa"
                function: "get_bin"
                fn_args:
                  - named_prop: "agr_sum_vl_indicador"
                  - fixed: [10,50,100,500,1000,2000,5000,10000,20000,40000]
              - id: "deviation"
                function: "get_log"
                fn_args:
                  - fixed: "agr_sum_vl_indicador"
            formatters:
              - id: "agr_sum_vl_indicador"
                format: 'inteiro'
        headers:
          - text: 'Unidade Federativa'
            align: 'left'
            value: 'nm_uf'
          # - text: 'Nº de migrantes de outras nacionalidades admitidos'
          #   value: 'fmt_agr_sum_vl_indicador'
          - text: 'Nº de migrantes de outras nacionalidades admitidos'
            value: 'calc_faixa'
        chart_options:
          id_field: 'cd_uf'
          topo_key: "codigo"
          value_field: 'calc_deviation'
          colorScale:
            name: 'Reds'
        source:
          desc_field: "ds_fonte"
# ========================================================
      - id: "mapa_imigrantes_admitidos_calor"
        chart_type: "MAP_HEAT"
        title: 
          fixed: "Mapa de Calor - Distribuição Geográfica de Contratações de Trabalhadores migrantes de outras nacionalidades"
        title_comment:
          template: "{0}, de {1} a {2}"
          api:
            fixed: "/indicadoresnacionais?categorias=nu_competencia_max,nu_competencia_min&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
            - fixed: "2015"
            - named_prop: "nu_competencia_max"
        # info:
        #   - type: "text"
        #     title: "Sobre"
        #     content:
        #       fixed: ""
        description:
          - type: "text"
            title: ""
            content:
              fixed: "Este mapa de calor representa dinamicamente, conforme suas cores, medidas da intensidade da ocorrência de admissão de trabalhadores migrantes de outras nacionalidades. A variação de cores frias para cores quentes (de forma crescente) indica locais de maior intensidade de contratação de migrantes de outras nacionalidades."
          - type: "slider"
            cls: "pl-2"
            id: "slider_periodo"
            range: true
            title: ""
            api:
              fixed: "/indicadoresnacionais?categorias=nu_competencia_max&limit=1&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
            args:
              - prop: "min"
                fixed: "2015"
              - prop: "max"
                named_prop: "nu_competencia_max"
            selection:
              event: "selection"
              rules:
                filter: ",and,ge-nu_competencia-'{0}',and,le-nu_competencia-'{1}'"
                api:
                  args:
                    - named_prop: "value_min"
                    - named_prop: "value_max"
          - id: "select_origem"
            type: "select"
            label: "Origem/Continente"
            api:
              fixed: "/indicadoresnacionais?categorias=ds_agreg_primaria&agregacao=distinct&ordenacao=ds_agreg_primaria&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS'"
            args:
              - prop: "id"
                named_prop: "ds_agreg_primaria"
              - prop: "label"
                named_prop: "ds_agreg_primaria"
                null_value: "(Não informado)"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-ds_agreg_primaria-'{0}'"
                api:
                  args:
                    - named_prop: "ds_agreg_primaria"
        api:
          fixed: "/indicadoresmunicipais?categorias=cd_indicador,cd_mun_ibge,nm_municipio_uf,ds_fonte,latitude,longitude&valor=vl_indicador&agregacao=SUM&filtros=eq-cd_indicador-'MIGRA_ATIVOS_CONTRATADOS',and,ge-nu_competencia-'2015'"
          options:
            calcs:
              - id: "faixa"
                function: "get_bin"
                fn_args:
                  - named_prop: "agr_sum_vl_indicador"
                  - fixed: [10,50,100,500,1000,2000,5000,10000,20000,40000]
            formatters:
              - id: "agr_sum_vl_indicador"
                format: 'inteiro'
        headers:
          - text: 'Município'
            align: 'left'
            value: 'nm_municipio_uf'
          # - text: 'Nº de trabalhadores migrantes de outras nacionalidades admitidos'
          #   value: 'fmt_agr_sum_vl_indicador'
          - text: 'Nº de trabalhadores migrantes de outras nacionalidades admitidos'
            value: 'calc_faixa'
        chart_options:
          height_proportion: 1.77
          type: 'heat'
          lat: 'latitude'
          long: 'longitude'
          indicadores: ["MIGRA_ATIVOS_CONTRATADOS"]
          value_field: 'agr_sum_vl_indicador'
        source:
          desc_field: "ds_fonte"

