# ====================================================          
params:
  - name: "sst_cat"
    api:
      fixed: "/sst/cats?categorias=1&valor=ano_cat&agregacao=MIN,MAX"
      options:
        calcs:
          - id: "ano_cat_ultimos_5"
            function: "calc_subtraction_ds"
            fn_args:
              - named_prop: "agr_max_ano_cat"
              - fixed: 4
  - name: "sst_sinan"
    api:
      fixed: "/indicadoresnacionais?categorias=nu_competencia_min,nu_competencia_max&filtros=eq-cd_indicador-'06_05_13_00'&limit=1"
      options:
        calcs:
          - id: "nu_competencia_ultimos_5"
            function: "calc_subtraction_ds"
            fn_args:
              - named_prop: "nu_competencia_max"
              - fixed: 4
# ====================================================          
principais:
  - relevance: 'lead' 
    cls: 'xs12 xl6'
    rowClass: "pt-0 px-3 pb-5"
    api: 
      template: "/ti/provabrasil?categorias=nu_ano_prova_brasil,nm_municipio&valor=vl_indicador&agregacao=SUM&filtros=eq-nu_ano_prova_brasil-2017,and,eq-cd_tr_fora-1,and,eq-cd_uf-{0}&ordenacao=-agr_sum_vl_indicador&limit=1"
      args:
        - named_prop: "cd_uf"
    args:
      - prop: "value"
        named_prop: 'nm_municipio'
        default: "Sem Registros"
        zero: "Nenhum"
      - prop: "description"
        fixed: 'Município da UF com o maior número de estudantes que declararam trabalhar fora de casa'
      - prop: "comment"
        template: '(Prova Brasil, {0})'
        args:
          - named_prop: "nu_ano_prova_brasil"
  - relevance: 'lead' 
    cls: 'xs12 xl6'
    rowClass: "pt-0 px-3 pb-5"
    api: 
      template: "/indicadoresmunicipais?categorias=ds_fonte,nu_competencia,nm_municipio,vl_indicador&ordenacao=-vl_indicador&limit=1&filtros=eq-cd_indicador-'CAGRO_TICA01',and,eq-nu_competencia-nu_competencia_max,and,eq-cd_uf-{0}"
      args:
        - named_prop: "cd_uf"
    args:
      - prop: "value"
        named_prop: 'nm_municipio'
        default: "Sem Registros"
        zero: "Nenhum"
      - prop: "description"
        fixed: 'Município da UF com o maior número de crianças ou adolescentes menores de 14 anos ocupados em estabelecimentos agropecuários'
      - prop: "comment"
        template: '({0}, {1})'
        args:
          - named_prop: "ds_fonte"
          - named_prop: "nu_competencia"
  - relevance: 'lead' 
    cls: 'xs12 xl6'
    rowClass: "pt-0 px-3 pb-5"
    api: 
      template: "/ti/mapear?categorias=nm_municipio,nu_competencia&agregacao=COUNT&limit=1&ordenacao=-agr_count&filtros=eq-nu_competencia-nu_competencia_max,and,eq-cd_uf-{0}"
      args:
        - named_prop: "cd_uf"
    args:
      - prop: "value"
        named_prop: 'nm_municipio'
        default: "Sem Registros"
        zero: "Nenhum"
      - prop: "description"
        fixed: 'Município da UF com maior número de pontos de risco de exploração sexual comercial de crianças e adolescentes'
      - prop: "comment"
        template: '(PRF - MAPEAR, {0})'
        args:
          - named_prop: "nu_competencia"
# ========================================================
secoes:
  - id: 'comparativa'
    name: 'Análise Comparativa na Unidade Federativa'
    cards:
# ========================================================
      - id: "datatable_infantil"
        title: 
          fixed: "Panorama de indicadores sobre o trabalho de crianças e adolescentes, inclusive em suas piores formas"
        title_comment:
          api: 
            template: "/municipios?categorias=nm_uf&filtros=eq-cd_municipio_ibge_dv-{0}"
            args:
              - named_prop: "idLocalidade"
          template: "{0}"
          args:
            - named_prop: "nm_uf"
        # info:
        #   - type: "text"
        #     title: "Sobre a métrica"
        #     content:
        #       fixed: "O total de resgates foi calculado com base em informações extraídas do Radar SIT - Painel de Informações e Estatísticas da Inspeção do Trabalho no Brasil, que inclui beneficiários e não-beneficiários do Seguro-Desemprego modalidade trabalhador resgatado."
        #   - type: "text"
        #     title: "Observação Importante"
        #     content:
        #       fixed: "Esse tipo de informação ajuda gestores na definição de regiões geográficas prioritárias para atividades de combate e prevenção, as quais também obedecem a lógica das curvas de oferta e de demanda do trabalho escravo no Brasil. Ilustrativamente, locais de maior intensidade de resgates devem ser prioritários quanto a atividades de inspeção do trabalho, sobretudo quanto às operações promovidas pela Divisão de Fiscalização para Erradicação do Trabalho Escravo (DETRAE – Ministério do Trabalho) e pelas equipes interinstitucionais do Grupo Especial de Fiscalização Móvel, conjuntamente com as ações coordenadas no âmbito das Superintendências Regionais do Trabalho nos Estados. Nesses locais, a orquestração interinstitucional fomenta e facilita a atuação efetiva e eficiente de operadores da lei, incluindo as forças policiais, da Justiça e do Ministério Público.<br/><br/>
        #               Importante também observar que de acordo com Objetivo 8 – Trabalho Decente e Crescimento Econômico - dos Objetivos de Desenvolvimento Sustentável da ONU (Agenda 2030), a meta 8,7 estabelece: Tomar medidas imediatas e eficazes para erradicar o trabalho forçado, acabar com a escravidão moderna e o tráfico de pessoas, e assegurar a proibição e eliminação das piores formas de trabalho infantil, incluindo recrutamento e utilização de crianças-soldado, e até 2025 acabar com o trabalho infantil em todas as suas formas."
        description:
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12'
                api: 
                  template: "/ti/provabrasil?categorias=nm_municipio&valor=vl_indicador&agregacao=SUM&filtros=eq-nu_ano_prova_brasil-2017,and,eq-cd_tr_fora-1,and,eq-cd_uf-{0}&ordenacao=-agr_sum_vl_indicador&limit=1"
                  args:
                    - named_prop: "cd_uf"
                args:
                  - prop: "value"
                    named_prop: 'nm_municipio'
                    default: "Sem Registros"
                    zero: "Nenhum"
                  - prop: "description"
                    fixed: 'Município da UF com o maior número de estudantes que declararam trabalhar fora de casa'
                  - prop: "comment"
                    template: 'Total: {0}'
                    args:
                      - named_prop: "agr_sum_vl_indicador"
                        format: "inteiro"
              - relevance: 'high'
                cls: 'xs12'
                api: 
                  template: "/indicadoresmunicipais?categorias=nm_municipio,vl_indicador&ordenacao=-vl_indicador&limit=1&filtros=eq-cd_indicador-'CAGRO_TICA01',and,eq-nu_competencia-nu_competencia_max,and,eq-cd_uf-{0}"
                  args:
                    - named_prop: "cd_uf"
                args:
                  - prop: "value"
                    named_prop: 'nm_municipio'
                    default: "Sem Registros"
                    zero: "Nenhum"
                  - prop: "description"
                    fixed: 'Município da UF com o maior número de crianças ou adolescentes menores de 14 anos ocupados em estabelecimentos agropecuários'
                  - prop: "comment"
                    template: 'Total: {0}'
                    args:
                      - named_prop: "vl_indicador"
                        format: "inteiro"
          - type: "text"
            title: ""
            content:
              fixed: "Com o fim de auxiliar a estruturação e o monitoramento das políticas públicas e ações para promoção dos direitos de crianças e adolescentes e para a prevenção e erradicação do trabalho infantil, os indicadores apresentados ao lado permitem mostrar a multidimensionalidade do fenômeno do trabalho infantil. Do ponto de vista da prevenção, deve-se dar destaque à aprendizagem profissional como um elemento estratégico do processo de transição escola-trabalho, a favorecer grupos etários de adolescentes e jovens com maiores dificuldades de inclusão sócio-produtiva. Quanto aos demais indicadores, os números, sobretudo quando representativos em mais de uma coluna, revelam sinais de que tais localidades demandam ações prioritárias quanto a ações/programas de combate ao trabalho infantil, inclusive em suas piores formas."
        component_type: "DATATABLE"
        api:
          - template: "/indicadoresmunicipais?categorias='bom'-class_indicador,cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,cd_indicador,ds_indicador_curto-ds_indicador,nu_competencia_min,nu_competencia_max,vl_indicador-agr_sum_vl_indicador,ds_indicador_prefixo,rank_uf,rank_br,media_br,media_uf&filtros=eq-nu_competencia-nu_competencia_max,and,nn-vl_indicador,and,in-cd_indicador-'APRZ_21_001'-'APRZ_21_009',and,eq-cd_uf-{0}&ordenacao=ds_indicador_curto"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} ({1})"
                        args:
                          - named_prop: "ds_indicador"
                          - function: "format_month"
                            fn_args:
                              - named_prop: "nu_competencia_max"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "ds_indicador_prefixo"
                - id: "det_value"
                  function: "get_detail_value"
                  fn_args:
                    - named_prop: "class_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "rank_br"
                    - named_prop: "rank_uf"
                    - named_prop: "media_br"
                    - named_prop: "media_uf"
          - template: "/sst/cats?categorias=cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,'Acidentes de Trabalho envolvendo Crianças ou Adolescentes'-ds_indicador&agregacao=COUNT&ordenacao=-agr_count&filtros=eq-cd_uf-{0},and,le-idade_cat-17,and,ne-idade_cat-0"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} - CAT ({1}-{2})"
                        args:
                          - named_prop: "ds_indicador"
                          - base_object: "sst_cat"
                            named_prop: "agr_min_ano_cat"
                          - base_object: "sst_cat"
                            named_prop: "agr_max_ano_cat"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_count"
                    - named_prop: "ds_indicador_prefixo"
              clone:
                - id: "agr_count"
                  new_column: "agr_sum_vl_indicador"
          - template: "/indicadoresmunicipais?categorias='ruim'-class_indicador,cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,cd_indicador,ds_indicador_curto-ds_indicador,nu_competencia_max,ds_indicador_prefixo&valor=vl_indicador&agregacao=SUM&filtros=nn-vl_indicador,and,eq-cd_indicador-'06_05_13_00',and,eq-cd_uf-{0},and,ge-nu_competencia-'{1}'"
            args:
              - named_prop: "cd_uf"
              - base_object: "sst_sinan"
                named_prop: "calc_nu_competencia_ultimos_5"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} ({1}-{2})"
                        args:
                          - named_prop: "ds_indicador"
                          - base_object: "sst_sinan"
                            named_prop: "calc_nu_competencia_ultimos_5"
                          - base_object: "sst_sinan"
                            named_prop: "nu_competencia_max"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "ds_indicador_prefixo"
          - template: "/indicadoresmunicipais?categorias='ruim'-class_indicador,cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,cd_indicador,ds_indicador_curto-ds_indicador,nu_competencia_min,nu_competencia_max,ds_indicador_prefixo&valor=vl_indicador&agregacao=SUM&filtros=nn-vl_indicador,and,eq-cd_indicador-'DISQUE100',and,eq-ds_agreg_primaria-'Trabalho Infantil',and,eq-cd_uf-{0}&ordenacao=ds_indicador_curto"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} ({1}-{2})"
                        args:
                          - named_prop: "ds_indicador"
                          - named_prop: "nu_competencia_min"
                          - named_prop: "nu_competencia_max"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "ds_indicador_prefixo"
          - template: "/ti/mapear?categorias=cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,'Pontos de Risco de Exploração Sexual Comercial de Crianças e Adolescente'-ds_indicador,nu_competencia&agregacao=COUNT&filtros=eq-nu_competencia-nu_competencia_max,and,eq-cd_uf-{0}"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} ({1})"
                        args:
                          - named_prop: "ds_indicador"
                          - named_prop: "nu_competencia"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_count"
                    - named_prop: "ds_indicador_prefixo"
              clone:
                - id: "agr_count"
                  new_column: "agr_sum_vl_indicador"
          - template: "/indicadoresmunicipais?categorias='ruim'-class_indicador,cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,cd_indicador,ds_indicador,nu_competencia_min,nu_competencia_max,ds_indicador_prefixo,rank_uf,rank_br,media_br,media_uf&valor=vl_indicador&agregacao=SUM&filtros=eq-nu_competencia-nu_competencia_max,and,nn-vl_indicador,and,eq-cd_indicador-'CAGRO_TICA01',and,eq-cd_uf-{0}"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} ({1})"
                        args:
                          - named_prop: "ds_indicador"
                          - named_prop: "nu_competencia_max"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "ds_indicador_prefixo"
                - id: "det_value"
                  function: "get_detail_value"
                  fn_args:
                    - named_prop: "class_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "rank_br"
                    - named_prop: "rank_uf"
                    - named_prop: "media_br"
                    - named_prop: "media_uf"
          - template: "/indicadoresmunicipais?categorias='ruim'-class_indicador,cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,cd_indicador,ds_indicador,nu_competencia_min,nu_competencia_max,ds_indicador_prefixo,rank_uf,rank_br,media_br,media_uf,vl_indicador-agr_sum_vl_indicador&filtros=eq-nu_competencia-nu_competencia_max,and,nn-vl_indicador,and,eq-cd_indicador-'TI_SIT_01',and,eq-cd_uf-{0}"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "Trabalho Infantil identificado pela Inspeção ({1})"
                        args:
                          - named_prop: "ds_indicador"
                          - named_prop: "nu_competencia_max"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "ds_indicador_prefixo"
                - id: "det_value"
                  function: "get_detail_value"
                  fn_args:
                    - named_prop: "class_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "rank_br"
                    - named_prop: "rank_uf"
                    - named_prop: "media_br"
                    - named_prop: "media_uf"
          - template: "/ti/provabrasil?categorias='ruim'-class_indicador,nu_ano_prova_brasil-nu_competencia,cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,ds_indicador,'(Quantidade)'-ds_indicador_prefixo&valor=vl_indicador&agregacao=SUM&filtros=nn-vl_indicador,and,ne-vl_indicador-0,and,eq-nu_ano_prova_brasil-2017,and,eq-cd_tr_fora-1,and,eq-cd_uf-{0}"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} ({1})"
                        args:
                          - named_prop: "ds_indicador"
                          - named_prop: "nu_competencia"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "ds_indicador_prefixo"
          - template: "/indicadoresmunicipais?categorias='ruim'-class_indicador,cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,cd_indicador,ds_indicador,nu_competencia_min,nu_competencia_max,ds_indicador_prefixo,rank_uf,rank_br,media_br,media_uf&valor=vl_indicador&agregacao=SUM&filtros=eq-nu_competencia-nu_competencia_max,and,nn-vl_indicador,and,eq-cd_indicador-'JD_CADUN_02',and,eq-cd_uf-{0}&ordenacao=-cd_indicador"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} ({1})"
                        args:
                          - named_prop: "ds_indicador"
                          - named_prop: "nu_competencia_max"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "ds_indicador_prefixo"
                - id: "det_value"
                  function: "get_detail_value"
                  fn_args:
                    - named_prop: "class_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "rank_br"
                    - named_prop: "rank_uf"
                    - named_prop: "media_br"
                    - named_prop: "media_uf"
        headers:
          - text: 'Município'
            align: 'center'
            value: 'nm_municipio'
            item_align: 'center'
          - text: 'UF'
            align: 'center'
            value: 'sg_uf'
            item_align: 'center'
        component_options:
          id: "datatable_ti"
          title: "Panorama comparativo e Potenciais Áreas Prioritárias"
          cls: "xs12 md6 lg4 pa-3"
          pivot: 
            col_fields: ["cd_mun_ibge","nm_municipio","sg_uf"]
            layer_field: "calc_header_label"
            fmt_value_field: "calc_fmt_value"
            value_field: "agr_sum_vl_indicador"
            det_value_field: "calc_det_value"
          search_position: "bottom"
        source:
          desc: "ME - RAIS e Novo CAGED, ME - IDEB/SIT, INSS - CATWEB, MS - SINAN, Disque Direitos Humanos (Disque 100), PRF - MAPEAR, IBGE - Censo Agropecuário, ME - SIT, Prova Brasil e Ministério da Cidadania - SAGI/VIS DATA."

# ========================================================
      - id: "datatable_infantil_munic"
        title: 
          fixed: "Panorama comparativo de algumas ações de enfrentamento do trabalho Infantil e proteção integral de crianças e de adolescentes"
        title_comment:
          api: 
            template: "/municipios?categorias=nm_uf&filtros=eq-cd_municipio_ibge_dv-{0}"
            args:
              - named_prop: "idLocalidade"
          template: "{0}"
          args:
            - named_prop: "nm_uf"
        # info:
        #   - type: "text"
        #     title: "Sobre a métrica"
        #     content:
        #       fixed: "O total de resgates foi calculado com base em informações extraídas do Radar SIT - Painel de Informações e Estatísticas da Inspeção do Trabalho no Brasil, que inclui beneficiários e não-beneficiários do Seguro-Desemprego modalidade trabalhador resgatado."
        #   - type: "text"
        #     title: "Observação Importante"
        #     content:
        #       fixed: "Esse tipo de informação ajuda gestores na definição de regiões geográficas prioritárias para atividades de combate e prevenção, as quais também obedecem a lógica das curvas de oferta e de demanda do trabalho escravo no Brasil. Ilustrativamente, locais de maior intensidade de resgates devem ser prioritários quanto a atividades de inspeção do trabalho, sobretudo quanto às operações promovidas pela Divisão de Fiscalização para Erradicação do Trabalho Escravo (DETRAE – Ministério do Trabalho) e pelas equipes interinstitucionais do Grupo Especial de Fiscalização Móvel, conjuntamente com as ações coordenadas no âmbito das Superintendências Regionais do Trabalho nos Estados. Nesses locais, a orquestração interinstitucional fomenta e facilita a atuação efetiva e eficiente de operadores da lei, incluindo as forças policiais, da Justiça e do Ministério Público.<br/><br/>
        #               Importante também observar que de acordo com Objetivo 8 – Trabalho Decente e Crescimento Econômico - dos Objetivos de Desenvolvimento Sustentável da ONU (Agenda 2030), a meta 8,7 estabelece: Tomar medidas imediatas e eficazes para erradicar o trabalho forçado, acabar com a escravidão moderna e o tráfico de pessoas, e assegurar a proibição e eliminação das piores formas de trabalho infantil, incluindo recrutamento e utilização de crianças-soldado, e até 2025 acabar com o trabalho infantil em todas as suas formas."
        description:
          # - type: "minicards"
          #   cards:
          #     - relevance: 'high'
          #       cls: 'xs12'
          #       api: 
          #         - template: "/orgs/assistenciasocial?categorias=%27com_creas%27-cd_indicador&valor=cd_municipio_ibge_dv&agregacao=COUNT&filtros=eq-categoria-%27CREAS%27,and,eq-cd_uf-{0}"
          #           args:
          #             - named_prop: "cd_uf"
          #         - template: "/municipios?categorias='total'-cd_indicador&agregacao=COUNT&filtros=eq-cd_uf-{0}"
          #           args:
          #             - named_prop: "cd_uf"
          #       api_options:
          #         combine:
          #         - id: "sem_creas"
          #           desc: "Total de Municípios sem CREAS"
          #           function: 'calc_subtraction'
          #           fn_args:
          #             - id: "total"
          #               named_prop: "agr_count"
          #             - id: "com_creas"
          #               named_prop: "agr_count_cd_municipio_ibge_dv"
          #       args:
          #         - prop: "value"
          #           id: "sem_creas"
          #           named_prop: 'vl_indicador'
          #           format: "inteiro"
          #           default: "Sem Registros"
          #           zero: "Nenhum"
          #         - prop: "description"
          #           fixed: 'MUNICÍPIOS SEM CREAS'
          #         - prop: "comment"
          #           template: '{0} de {1} municípios'
          #           args:
          #             - id: "sem_creas"
          #               named_prop: "vl_indicador"
          #               format: "inteiro"
          #             - id: "total"
          #               named_prop: "agr_count"
          #               format: "inteiro"
          #     - relevance: 'high'
          #       cls: 'xs12'
          #       api: 
          #         - template: "/orgs/assistenciasocial?categorias=%27com_cras%27-cd_indicador&valor=cd_municipio_ibge_dv&agregacao=COUNT&filtros=eq-categoria-%27CRAS%27,and,eq-cd_uf-{0}"
          #           args:
          #             - named_prop: "cd_uf"
          #         - template: "/municipios?categorias='total'-cd_indicador&agregacao=COUNT&filtros=eq-cd_uf-{0}"
          #           args:
          #             - named_prop: "cd_uf"
          #       api_options:
          #         combine:
          #         - id: "sem_cras"
          #           desc: "Total de Municípios sem CRAS"
          #           function: 'calc_subtraction'
          #           fn_args:
          #             - id: "total"
          #               named_prop: "agr_count"
          #             - id: "com_cras"
          #               named_prop: "agr_count_cd_municipio_ibge_dv"
          #       args:
          #         - prop: "value"
          #           id: "sem_cras"
          #           named_prop: 'vl_indicador'
          #           format: "inteiro"
          #           default: "Sem Registros"
          #           zero: "Nenhum"
          #         - prop: "description"
          #           fixed: 'MUNICÍPIOS SEM CRAS'
          #         - prop: "comment"
          #           template: '{0} de {1} municípios'
          #           args:
          #             - id: "sem_cras"
          #               named_prop: "vl_indicador"
          #               format: "inteiro"
          #             - id: "total"
          #               named_prop: "agr_count"
          #               format: "inteiro"
          - type: "text"
            title: ""
            content:
              fixed: "Além de informações obtidas do Censo SUAS, os diferentes módulos da Pesquisa de Informações Básicas Municipais (MUNIC) do IBGE abordam aspectos relevantes de ações de promoção da proteção integral de crianças e adolescentes nos municípios brasileiros. Consideradas essas fontes, o conjunto de indicadores ao lado permite ponderar se os municípios se encontram em estado de alerta quanto à estrutura de políticas públicas. Trata-se de dez indicadores selecionados que podem trazer sinais não apenas da necessidade de aprimoramento das políticas e ações em destaque, mas também da possível vulnerabilidade das crianças e adolescentes nessas localidades. A ausência dessas políticas/programas/ações é, indubitavelmente, um alerta de risco."
        component_type: "DATATABLE"
        api:
          - template: "/indicadoresmunicipais?categorias='neutro'-class_indicador,cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,cd_indicador,ds_indicador_curto-ds_indicador,nu_competencia_min,nu_competencia_max,vl_indicador-agr_sum_vl_indicador,ds_indicador_prefixo,rank_uf,rank_br,media_br,media_uf&filtros=eq-nu_competencia-nu_competencia_max,and,nn-vl_indicador,and,in-cd_indicador-'POP_DOU_01',and,eq-cd_uf-{0}"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} ({1})"
                        args:
                          - named_prop: "ds_indicador"
                          - function: "format_scope"
                            fn_args:
                              - named_prop: "nu_competencia_max"
                              - fixed: "year"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "ds_indicador_prefixo"
                - id: "det_value"
                  function: "get_detail_value"
                  fn_args:
                    - named_prop: "class_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "rank_br"
                    - named_prop: "rank_uf"
                    - named_prop: "media_br"
                    - named_prop: "media_uf"
          - template: "/estadicmunic?categorias=cd_mun_ibge,nm_municipio,sg_uf,cd_indicador_spai-cd_indicador,spai_ds_texto-ds_indicador,spai_vl_indicador_txt-agr_sum_vl_indicador,nu_ano_indicador-nu_competencia,'(Sim/Não)'-ds_indicador_prefixo&filtros=eq-nu_ano_indicador-nu_ano_indicador_max,and,in-cd_indicador_spai-'MUNIC_MDHU602'-'MUNIC_MDHU604'-'MUNIC_MDHU609'-'MUNIC_MDHU607',and,eq-cd_uf-{0}&ordenacao=cd_indicador_spai"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} ({1})"
                        args:
                          - function: "capitalize_first_letter"
                            fn_args:
                              - named_prop: "ds_indicador"
                          - named_prop: "nu_competencia"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "ds_indicador_prefixo"
          - template: "/estadicmunic?categorias=cd_mun_ibge,nm_municipio,sg_uf,cd_indicador_spai-cd_indicador,spai_ds_texto-ds_indicador,spai_vl_indicador_txt-agr_sum_vl_indicador,nu_ano_indicador-nu_competencia,'(Sim/Não)'-ds_indicador_prefixo&filtros=eq-nu_ano_indicador-nu_ano_indicador_max,and,in-cd_indicador_spai-'91_06_02_01'-'91_06_02_02',and,eq-cd_uf-{0}&ordenacao=cd_indicador_spai"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} ({1})"
                        args:
                          - function: "capitalize_first_letter"
                            fn_args:
                              - named_prop: "ds_indicador"
                          - named_prop: "nu_competencia"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "ds_indicador_prefixo"
          - template: "/indicadoresmunicipais?categorias=cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,cd_indicador,ds_indicador_curto-ds_indicador,nu_competencia_max,ds_indicador_prefixo&valor=vl_indicador&agregacao=SUM&filtros=eq-nu_competencia-nu_competencia_max,and,nn-vl_indicador,and,eq-cd_indicador-'06_03_04_26',and,eq-cd_uf-{0}"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} ({1})"
                        args:
                          - named_prop: "ds_indicador"
                          - named_prop: "nu_competencia_max"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_sum_vl_indicador"
                    - named_prop: "ds_indicador_prefixo"
          - template: "/orgs/assistenciasocial?categorias=cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio,sg_uf,categoria-cd_indicador,categoria-ds_indicador,'(Quantidade)'-ds_indicador_prefixo&agregacao=COUNT&filtros=eq-cd_uf-{0}"
            args:
              - named_prop: "cd_uf"
            options:
              calcs:
                - id: "header_label"
                  function: "applyInterpolReplaceDatasetParam"
                  fn_args:
                    - fixed:
                        template: "{0} (2017)"
                        args:
                          - named_prop: "ds_indicador"
                - id: "fmt_value"
                  function: "get_formatted_value"
                  fn_args:
                    - named_prop: "ds_indicador"
                    - named_prop: "agr_count"
                    - named_prop: "ds_indicador_prefixo"
              clone:
                - id: "agr_count"
                  new_column: "agr_sum_vl_indicador"
        headers:
          - text: 'Município'
            align: 'center'
            value: 'nm_municipio'
            item_align: 'center'
          - text: 'UF'
            align: 'center'
            value: 'sg_uf'
            item_align: 'center'
        component_options:
          id: "datatable_ti_munic"
          title: "Ações Municipais quanto à proteção de crianças e adolescentes e ao trabalho infantil"
          cls: "xs12 md6 lg4 pa-3"
          pivot: 
            col_fields: ["cd_mun_ibge","nm_municipio","sg_uf"]
            layer_field: "calc_header_label"
            fmt_value_field: "calc_fmt_value"
            value_field: "agr_sum_vl_indicador"
            det_value_field: "calc_det_value"
          search_position: "bottom"
        source:
          desc: "IBGE - Pesquisa de Informações Municipais, MDS - Censo SUAS."

