principais:
  - relevance: 'lead' 
    cls: 'xs12 xl6'
    rowClass: "pt-0 px-3 pb-5"
    api:
      template: "/ti/mapear?categorias=1&agregacao=count&filtros=eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max"
      args:
        - named_prop: "idLocalidade"
    args:
      - prop: "value"
        named_prop: 'agr_count'
        format: 'inteiro'
        default: 'Nenhum'
      - prop: "description"
        fixed: "Pontos mapeados"
  - relevance: 'lead' 
    cls: 'xs12 xl6'
    rowClass: "pt-0 px-3 pb-5"
    api:
      template: "/ti/mapear?categorias=1&agregacao=count&filtros=eq-spai_id_explo_sexual_infantil-'Sim',and,eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max"
      args:
        - named_prop: "idLocalidade"
    args:
      - prop: "value"
        named_prop: 'agr_count'
        format: 'inteiro'
        default: 'Nenhum'
      - prop: "description"
        fixed: "Pontos em que já se constatou a exploração de crianças e adolescentes"
  - relevance: 'lead' 
    cls: 'xs12 xl6'
    rowClass: "pt-0 px-3 pb-5"
    api:
      template: "/ti/mapear?categorias=1&agregacao=count&filtros=eq-spai_id_atua_conselho_tutelar-'Sim',and,eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max"
      args:
        - named_prop: "idLocalidade"
    args:
      - prop: "value"
        named_prop: 'agr_count'
        format: 'inteiro'
        default: 'Nenhum'
      - prop: "description"
        fixed: "Pontos vulneráveis com atuação de conselhos tutelares"
  - relevance: 'lead' 
    cls: 'xs12 xl6'
    rowClass: "pt-0 px-3 pb-5"
    api:
      template: "/ti/mapear?categorias=1&agregacao=count&filtros=ne-spai_id_atua_conselho_tutelar-'Sim',and,eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max"
      args:
        - named_prop: "idLocalidade"
    args:
      - prop: "value"
        named_prop: 'agr_count'
        format: 'inteiro'
        default: 'Nenhum'
      - prop: "description"
        fixed: "Pontos vulneráveis sem atuação apurada de conselhos tutelares"

# ===================================================
secoes:
  - id: "entenda"
    cards:
# ====================================================          
      - id: "entenda_o_estudo"
        title: 
          fixed: "Sobre o estudo"

        type: "presentation"
        description:
          - type: "text"
            title: "Sobre o estudo"
            content:
              cls: "pa-3"
              api:
                - fixed: "/ti/mapear?categorias=nu_competencia,'ultimo'-cd_indicador&agregacao=count&filtros=eq-nu_competencia-nu_competencia_max"
                  options:
                    calcs:
                      - id: "proximo_ano"
                        function: "calc_addition_ids_ds"
                        fn_args:
                          - named_prop: "nu_competencia"
                          - fixed: 1
                          - fixed: 1
                    formatters:
                      - id: "agr_count"
                        format: 'inteiro'
                - fixed: "/ti/mapear?categorias=nu_competencia,'criticos_ultimo'-cd_indicador&agregacao=count&filtros=eq-nu_competencia-nu_competencia_max,and,eq-spai_ds_risco_nivel-'Crítico'"
                  options:
                    formatters:
                      - id: "agr_count"
                        format: 'inteiro'
                - fixed: "/ti/mapear?categorias=nu_competencia,'urbano'-cd_indicador&agregacao=count&filtros=eq-nu_competencia-nu_competencia_max,and,eq-ds_area-'Urbana'"
                  options:
                    formatters:
                      - id: "agr_count"
                        format: 'inteiro'
                - template: "/ti/mapear?categorias=nu_competencia,nu_competencia_max,'penultimo'-cd_indicador&agregacao=count&filtros=eq-nu_competencia-'{0}'"
                  args:
                    - base_object: "mapear"
                      named_prop: "calc_nu_competencia_anterior"
                  options:
                    formatters:
                      - id: "agr_count"
                        format: 'inteiro'
                - template: "/ti/mapear?categorias=nu_competencia,'criticos_penultimo'-cd_indicador&agregacao=count&filtros=eq-nu_competencia-'{0}',and,eq-spai_ds_risco_nivel-'Crítico'"
                  args:
                    - base_object: "mapear"
                      named_prop: "calc_nu_competencia_anterior"
                  options:
                    formatters:
                      - id: "agr_count"
                        format: 'inteiro'
              api_options:
                combine:
                  - id: "perc_criticos_ultimo"
                    desc: "% Pontos críticos ultimo"
                    function: 'calc_percentage'
                    fn_args:
                      - id: "criticos_ultimo"
                        named_prop: "agr_count"
                      - id: "ultimo"
                        named_prop: "agr_count"
                  - id: "perc_criticos_penultimo"
                    desc: "% Pontos críticos penultimo"
                    function: 'calc_percentage'
                    fn_args:
                      - id: "criticos_penultimo"
                        named_prop: "agr_count"
                      - id: "penultimo"
                        named_prop: "agr_count"
                  - id: "perc_aumento"
                    desc: "% Pontos críticos penultimo"
                    function: 'calc_percentage'
                    fn_args:
                      - id: "ultimo"
                        named_prop: "agr_count"
                      - id: "penultimo"
                        named_prop: "agr_count"
                  - id: "perc_urbano"
                    desc: "% Área Urbana"
                    function: 'calc_percentage'
                    fn_args:
                      - id: "urbano"
                        named_prop: "agr_count"
                      - id: "ultimo"
                        named_prop: "agr_count"
              template: "No biênio {0}/{1} foram mapeados {2} pontos vulneráveis à ESCA nas rodovias federais, dos quais {3} foram classificados como críticos, o que representa {4} do total de pontos catalogados. Comparado ao biênio anterior, no qual foram mapeados um total de {5} pontos, dos quais {6} foram classificados como críticos, houve um aumento de {7} no número global, o que possibilitará a ampliação das ações ao longo das rodovias federais, já que mais pontos totais mapeados significam um planejamento de operações mais próximo de cada necessidade local.<br/>
                      A realização de ações cada vez em maior escala nos últimos anos foi fator determinante para a redução do percentual de pontos críticos, os quais representavam {8} do total de pontos no biênio anterior, passando a representar {4} no atual mapeamento. Vale ressaltar que os pontos críticos são os de maior interesse operacional, pois reúnem os maiores fatores de vulnerabilidade em uma rodovia federal. Assim como no biênio anterior, constatamos que a maior parte dos pontos mapeados encontram-se em áreas urbanas, totalizando {9} dos casos. Assim como outros crimes, a Exploração Sexual de Crianças e Adolescentes (ESCA) depende de fluxo monetário e de pessoas nos locais, assim como de logística que facilite o acesso das crianças e adolescentes aos locais de exploração. Por se tratar de um tema complexo e ter em suas raízes variadas vulnerabilidades sociais, a ESCA carece de um fortalecimento constante da rede de apoio, que consiste na união de instituições públicas, privadas e da sociedade civil, pois o olhar e ação de apenas parte dessa cadeia de proteção compromete a mudança necessária à vida de uma vítima resgatada, assim como de sua família.<br/>
                      Toda criança ou adolescente resgatado em situação de vulnerabilidade, seja ela de efetiva exploração sexual, ou outra que a precede, traz consigo um histórico de direitos e acessos negados a cultura, lazer, educação, saúde ou ao convívio familiar sadio. Identificar qual a necessidade e perfil da criança e adolescente resgatado durante as operações que utilizam o Mapear como base de planejamento é um dos grandes objetivos do projeto, para que assim seja possível alimentar a rede de apoio com as informações necessárias à aplicação das mudanças. Neste contexto, somam-se à PRF as importantes parcerias com a Childhood Brasil, MDH, MPT, ASBRAD e Conselhos Tutelares que, através da troca de conhecimentos e atuação conjunta durante as operações, vêm buscando os melhores meios para prover uma entrega de excelência, não só para as crianças e adolescentes que carecem de proteção e tutela, mas para toda a sociedade."
              args:
                - id: "ultimo"
                  named_prop: "nu_competencia"
                - id: "ultimo"
                  named_prop: "calc_proximo_ano"
                - id: "ultimo"
                  named_prop: "fmt_agr_count"
                - id: "criticos_ultimo"
                  named_prop: "fmt_agr_count"
                - id: "perc_criticos_ultimo"
                  named_prop: "vl_indicador"
                  format: "porcentagem"
                - id: "penultimo"
                  named_prop: "fmt_agr_count"
                - id: "criticos_penultimo"
                  named_prop: "fmt_agr_count"
                - id: "perc_aumento"
                  named_prop: "vl_indicador"
                  format: "porcentagem"
                  precision: 2
                - id: "perc_criticos_penultimo"
                  named_prop: "vl_indicador"
                  format: "porcentagem"
                - id: "perc_urbano"
                  named_prop: "vl_indicador"
                  format: "porcentagem"
                  precision: 0
              columns: 3
      - id: "autores_do_estudo"
        title: 
          fixed: "Autores e Parceiros"
        type: "presentation"
        description:
          - type: "text"
            title: "Autores e Parceiros"
            content:
              cls: "pa-3"
              fixed: "<ul class='ident-list'><li>Autores do Estudo: Smartlab (MPT-OIT) e Comissão de Direitos Humanos da Polícia Rodoviária Federal (PRF)</li><li>Parceiros no Projeto Mapear: Polícia Rodoviária Federal (PRF), Ministério Público do Trabalho (MPT), Organização Internacional do Trabalho (OIT - Área de Princípios e Direitos Fundamentais do Trabalho), Childhood Brasil, Ministério da Mulher, da Família e dos Direitos Humanos, Secretaria Nacional dos Direitos da Criança e do Adolescente, Ministério do Trabalho e Emprego (Subsecretaria de Inspeção do Trabalho)</li></ul>"
# ====================================================                        

# ====================================================              
  # - id: "estudo_mapear"
  #   cards:
      - id: "card_conc_pontos_vulneraveis_uf"
        # type: "multiple-charts"
        title: 
          fixed: "Panorama da Vulnerabilidade à Exploração Sexual Comercial em Rodovias e Estradas Federais na UF"
        title_comment:
          template: "{0}"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
        description:
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12 md6'
                api:
                  template: "/ti/mapear?categorias=cd_municipio_ibge_dv,nm_municipio_uf&filtros=eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max&agregacao=count&ordenacao=-agr_count&limit=1"
                  args:
                    - named_prop : "idLocalidade"
                args:
                  - prop: "value"
                    named_prop: 'agr_count'
                    format: 'inteiro'
                    default: "Sem Registros"
                    zero: "Nenhum"
                  - prop: "description"
                    named_prop: 'nm_municipio_uf'
                  - prop: "comment"
                    fixed: "Município com maior quantidade de pontos"
          - id: "maintext_csec01_lf"
            type: "text"
            content: 
              fixed: "Em destaque, o município da unidade federativa com o maior número de pontos de vulnerabilidade à exploração sexual comercial de crianças e adolescentes, mapeados em rodovias e estradas federais. No mapa, comparam-se diferentes municípios da UF. A escala de cores varia do branco (menor quantidade de pontos) ao vermelho escuro (maior quantidade de pontos). Por meio do filtro abaixo, pode-se selecionar o grau de risco dos pontos e visualizar o mapa de acordo com a perspectiva escolhida. Note-se que o levantamento atinge apenas os municípios pelos quais passam rodovias e estradas federais. Desse modo, a inexistência de pontos mapeados não significa que não haja riscos ainda não identificados.<br/><br/>"

          - id: "select_risco"
            type: "select"
            label: "Grau de Risco de Exploração"
            api:
              fixed: "/ti/mapear?categorias=spai_ds_risco_nivel&agregacao=distinct&filtros=eq-nu_competencia-nu_competencia_max"
            args:
              - prop: "id"
                named_prop: "spai_ds_risco_nivel"
              - prop: "label"
                named_prop: "spai_ds_risco_nivel"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_ds_risco_nivel-'{0}'"
                api:
                  args:
                    - named_prop: "spai_ds_risco_nivel"
          - id: "check_con_tutelar"
            title: "Características Confirmadas:"
            cls: "px-2 py-0"
            type: "check"
            label: "Ausência de Atuação do Conselho Tutelar Reportada"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_atua_conselho_tutelar-'Sim'"
                filter_text: "com ausência de atuação do Conselho Tutelar Reportada"
          - id: "check_drogas"
            cls: "px-2 py-0"
            type: "check"
            label: "Consumo de Drogas Identificado"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_reg_traf_consumo_droga-'Sim'"
                filter_text: "com consumo de drogas identificado"
          - id: "check_prostituicao"
            cls: "px-2 py-0"
            type: "check"
            label: "Pontos de prostituição"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_prostituicao_adulto-'Sim'"
                filter_text: "com pontos de prostituição"
          - id: "check_alcool"
            cls: "px-2 py-0"
            type: "check"
            label: "Consumo de Bebidas Alcóolicas Identificado"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_ponto_consumo_alcool -'Sim'"
                filter_text: "com consumo de bebida alcóolica identificado"
          # - id: "check_penumbra"
          #   cls: "px-2 py-0"
          #   type: "check"
          #   label: "Penumbra"
          #   value: false
          #   color: "accent"
          #   selection:
          #     event: "selection" 
          #     rules:
          #       filter: ",and,eq-spai_id_iluminacao_area-'Penumbra'"
          #       filter_text: "com pouca iluminação(Penumbra)"
        chart_type: "MAP_TOPOJSON"
        api: 
          template: "/ti/mapear?categorias=cd_municipio_ibge_dv,nm_municipio_uf&agregacao=count&ordenacao=-agr_count&filtros=eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max"
          args:
            - named_prop: "cd_uf"
        headers:
          - text: 'Município'
            align: 'left'
            value: 'nm_municipio_uf'
          - text: 'Número de pontos vulneráveis monitorados'
            value: 'agr_count'
        chart_options:
          id_field: 'cd_municipio_ibge_dv'
          topo_key: "codarea"
          value_field: 'agr_count'
          colorScale:
            name: 'Reds'
        source:
          fixed: "MAPEAR"
# # ========================================================
#       - id: "mapa_conc_pontos_vulneraveis_uf"
#         title: 
#           fixed: "Crianças e Adolescentes em Situação de Vulnerabilidade em Rodovias e Estradas Federais Brasileiras - Municípios"
#         title_comment:
#           template: "{0}"
#           args:
#             - base_object: "localidade"
#               named_prop: "nm_localidade"
#         description:
#           - id: "maintext_csec01_lf"
#             type: "text"
#             content: 
#               fixed: "Em destaque, as localidades da unidade federativa selecionada, pelas quais passam rodovias e estradas federais, em que foram encontradas crianças e adolescentes em situação de vulnerabilidade à exploração sexual comercial. A escala de cores varia do branco (não visitado ou não apurado) ao vermelho escuro (maior quantidade de casos na localidade)."
#         chart_type: "MAP_TOPOJSON"
#         api: 
#           template: "/ti/mapear?categorias=cd_municipio_ibge_dv,nm_municipio_uf&filtros=eq-spai_id_crianca_adolec_local-'Sim',and,eq-cd_uf-{0}&agregacao=count&ordenacao=-agr_count"
#           args:
#             - named_prop: "idLocalidade"
#         headers:
#           - text: 'Município'
#             align: 'left'
#             value: 'nm_municipio_uf'
#           - text: 'Número de pontos vulneráveis'
#             value: 'agr_count'
#         chart_options:
#           id_field: 'cd_municipio_ibge_dv'
#           topo_key: "codarea"
#           value_field: 'agr_count'
#           colorScale:
#             name: 'Reds'
# ========================================================
      - id: "mapa_prev_municipios_br_cluster"
        title: 
          fixed: "Grupos de Municípios com Pontos de Vulnerabilidade à Exploração Sexual Comercial de Crianças e Adolescentes"
        title_comment:
          template: "{0}"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
        info:
          - type: "text"
            title: "Sobre"
            content:
              fixed: ""
        description:
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12 md6'
                api:
                  template: "/ti/mapear?categorias=1&agregacao=count&filtros=eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max"
                  args:
                    - named_prop : "idLocalidade"
                args:
                  - prop: "value"
                    named_prop: 'agr_count'
                    format: 'inteiro'
                    default: "Nenhum"
                    zero: "Nenhum"
                  - prop: "description"
                    fixed: "Pontos vulneráveis monitorados"
              # - relevance: 'high'
              #   cls: 'xs12 md6'
              #   api:
              #     template: "/ti/mapear?categorias=cd_municipio_ibge_dv,nm_municipio_uf&filtros=eq-cd_uf-{0}&agregacao=count&ordenacao=-agr_count&limit=1"
              #     args:
              #       - named_prop: "idLocalidade"                    
              #   args:
              #     - prop: "value"
              #       named_prop: 'agr_count'
              #       format: 'inteiro'
              #       default: "Nenhum"
              #       zero: "Nenhum"
              #     - prop: "description"
              #       named_prop: 'nm_municipio_uf'
              #     - prop: "comment"
              #       fixed: "Município com maior quantidade de pontos"
          - type: "text"
            title: ""
            content:
              fixed: "Em destaque, de acordo com a perspectiva geográfica selecionada, o total de pontos de vulnerabilidade à exploração sexual comercial de crianças e adolescentes, mapeados em rodovias e estradas federais brasileiras. O mapa ao lado agrupa municípios com essa característica e permite identificar regiões de concentração de riscos. No caso, esse agrupamento se explica pela localização dos municípios ao longo de rodovias e estradas federais, em que lógica econômica da oferta e da demanda favorece a vulnerabiliadade. A marcação dos pontos no mapa permite identificar mais claramente, nas rotas de rodovias e estradas federais, os trechos de maior risco. Note-se que o levantamento atinge apenas os municípios pelos quais passam rodovias e estradas federais. Desse modo, a inexistência de pontos mapeados não significa que não haja riscos ainda não identificados."
          - id: "select_risco"
            type: "select"
            label: "Grau de Risco de Exploração"
            api:
              fixed: "/ti/mapear?categorias=spai_ds_risco_nivel&agregacao=distinct&filtros=eq-nu_competencia-nu_competencia_max"
            args:
              - prop: "id"
                named_prop: "spai_ds_risco_nivel"
              - prop: "label"
                named_prop: "spai_ds_risco_nivel"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_ds_risco_nivel-'{0}'"
                api:
                  args:
                    - named_prop: "spai_ds_risco_nivel"
          - id: "check_con_tutelar"
            title: "Características Confirmadas:"
            cls: "px-2 py-0"
            type: "check"
            label: "Ausência de Atuação do Conselho Tutelar Reportada"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_atua_conselho_tutelar-'Sim'"
                filter_text: "com ausência de atuação do Conselho Tutelar Reportada"
          - id: "check_drogas"
            cls: "px-2 py-0"
            type: "check"
            label: "Consumo de Drogas Identificado"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_reg_traf_consumo_droga-'Sim'"
                filter_text: "com consumo de drogas identificado"
          - id: "check_prostituicao"
            cls: "px-2 py-0"
            type: "check"
            label: "Pontos de prostituição"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_prostituicao_adulto-'Sim'"
                filter_text: "com pontos de prostituição"
          - id: "check_alcool"
            cls: "px-2 py-0"
            type: "check"
            label: "Consumo de Bebidas Alcóolicas Identificado"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_ponto_consumo_alcool -'Sim'"
                filter_text: "com consumo de bebida alcóolica identificado"
          # - id: "check_penumbra"
          #   cls: "px-2 py-0"
          #   type: "check"
          #   label: "Penumbra"
          #   value: false
          #   color: "accent"
          #   selection:
          #     event: "selection" 
          #     rules:
          #       filter: ",and,eq-spai_id_iluminacao_area-'Penumbra'"
          #       filter_text: "com pouca iluminação(Penumbra)"
        chart_type: "MAP_CLUSTER"
        api:
          template: "/ti/mapear?categorias='cd_indicador',cd_municipio_ibge_dv,nm_municipio_uf,latitude,longitude&agregacao=count&filtros=eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max"
          args:
            - named_prop: "idLocalidade"
        headers:
          - text: 'Município'
            align: 'left'
            value: 'nm_municipio_uf'
          - text: 'Número de pontos vulneráveis monitorados'
            value: 'agr_count'
        chart_options:
          id_field: "'cd_indicador'"
          height_proportion: 1.77
          colorArray: ["rgba(25, 125, 25, 0.7)"]
          indicadores: ["cd_indicador"]
          lat: 'latitude'
          long: 'longitude'
# ========================================================
      - id: "treemap_conc_pontos_rodovia"
        title:
          fixed: "Concentração de Pontos Vulneráveis monitorados por Rodovia Federal"
        title_comment:
          template: "{0}"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
        description: 
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12 md6'
                api:
                  template: "/ti/mapear?categorias=ds_br&filtros=eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max&agregacao=count&ordenacao=-agr_count&limit=1"
                  args:
                    - named_prop : "idLocalidade"
                args:
                  - prop: "value"
                    named_prop: 'ds_br'
                    default: "Nenhuma"
                    zero: "Nenhuma"
                  - prop: "description"
                    fixed: "Maior número de pontos"
          - type: "text"
            title: ""
            content:
              fixed: "Em destaque, de acordo com a perspectiva geográfica selecionada, a rota com o maior número de pontos vulneráveis à exploração sexual comercial de crianças e adolescentes. No gráfico ao lado, apresenta-se a concentração percentual desses pontos em diferentes rodovias/estradas federais. Por meio do filtro abaixo, pode-se selecionar o grau de risco e visualizar o gráfico de acordo com a perspectiva escolhida."
          - id: "select_risco_treemap_rodovia"
            type: "select"
            label: "Grau de Risco de Exploração"
            api:
              fixed: "/ti/mapear?categorias=spai_ds_risco_nivel&agregacao=distinct&filtros=eq-nu_competencia-nu_competencia_max"
            args:
              - prop: "id"
                named_prop: "spai_ds_risco_nivel"
              - prop: "label"
                named_prop: "spai_ds_risco_nivel"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_ds_risco_nivel-'{0}'"
                api:
                  args:
                    - named_prop: "spai_ds_risco_nivel"
          - id: "check_con_tutelar"
            title: "Características Confirmadas:"
            cls: "px-2 py-0"
            type: "check"
            label: "Ausência de Atuação do Conselho Tutelar Reportada"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_atua_conselho_tutelar-'Sim'"
                filter_text: "com ausência de atuação do Conselho Tutelar Reportada"
          - id: "check_drogas"
            cls: "px-2 py-0"
            type: "check"
            label: "Consumo de Drogas Identificado"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_reg_traf_consumo_droga-'Sim'"
                filter_text: "com consumo de drogas identificado"
          - id: "check_prostituicao"
            cls: "px-2 py-0"
            type: "check"
            label: "Pontos de prostituição"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_prostituicao_adulto-'Sim'"
                filter_text: "com pontos de prostituição"
          - id: "check_alcool"
            cls: "px-2 py-0"
            type: "check"
            label: "Consumo de Bebidas Alcóolicas Identificado"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_ponto_consumo_alcool -'Sim'"
                filter_text: "com consumo de bebida alcóolica identificado"
          # - id: "check_penumbra"
          #   cls: "px-2 py-0"
          #   type: "check"
          #   label: "Penumbra"
          #   value: false
          #   color: "accent"
          #   selection:
          #     event: "selection" 
          #     rules:
          #       filter: ",and,eq-spai_id_iluminacao_area-'Penumbra'"
          #       filter_text: "com pouca iluminação(Penumbra)"
        chart_type: "TREEMAP"
        api: 
          template: "/ti/mapear?categorias=ds_br&agregacao=count&ordenacao=-agr_count&filtros=eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max"
          args:
            - named_prop: "idLocalidade"
        headers:
          - text: 'Rodovia'
            align: 'left'
            value: 'ds_br'
          - text: 'Qtde'
            value: 'agr_count'
        chart_options:
          id: "ds_br"
          text: "ds_br"
          size: "agr_count"
          colorScale:
            name: "BuGn"
            type: "singleHue"
            levels: 5
            order: 'asc'
# # ========================================================
#       - id: "treemap_conc_pontos_caracteristica"
#         title:
#           fixed: "Características principais dos pontos vulneráveis monitorados"
#         title_comment:
#           template: "{0}"
#           args:
#             - base_object: "localidade"
#               named_prop: "nm_localidade"
#         description: 
#           - type: "minicards"
#             cards:
#               - relevance: 'high'
#                 cls: 'xs12 md6'
#                 api:
#                   template: "/ti/mapear?categorias=1&agregacao=count&filtros=eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max"
#                   args:
#                     - named_prop : "idLocalidade"
#                 args:
#                   - prop: "value"
#                     named_prop: 'agr_count'
#                     format: 'inteiro'
#                     default: "Nenhum"
#                     zero: "Nenhum"
#                   - prop: "description"
#                     fixed: "Pontos vulneráveis monitorados"
#           - type: "text"
#             title: ""
#             content:
#               fixed: "Em destaque, de acordo com a perspectiva geográfica selecionada, o número de pontos vulneráveis à exploração sexual comercial de crianças e adolescentes. No gráfico ao lado, apresenta-se a distribuição dos pontos de acordo com as principais características dos trechos das rodovias e estradas federais em que houve constatação da vulnerabilidade. Por meio do filtro abaixo, pode-se selecionar o grau de risco e visualizar o gráfico de acordo com a perspectiva escolhida."
#           - id: "select_risco_treemap_caracteristica"
#             type: "select"
#             label: "Grau de Risco de Exploração"
#             api:
#               fixed: "/ti/mapear?categorias=spai_ds_risco_nivel&agregacao=distinct&filtros=eq-nu_competencia-nu_competencia_max"
#             args:
#               - prop: "id"
#                 named_prop: "spai_ds_risco_nivel"
#               - prop: "label"
#                 named_prop: "spai_ds_risco_nivel"
#             selection:
#               event: "selection" 
#               rules:
#                 filter: ",and,eq-spai_ds_risco_nivel-'{0}'"
#                 api:
#                   args:
#                     - named_prop: "spai_ds_risco_nivel"
#           - id: "check_drogas"
#             title: "Características Confirmadas:"
#             cls: "px-2 py-0"
#             type: "check"
#             label: "Consumo de drogas"
#             value: false
#             color: "accent"
#             selection:
#               event: "selection" 
#               rules:
#                 filter: ",and,eq-spai_id_reg_traf_consumo_droga-'Sim'"
#                 filter_text: "com consumo de drogas"
#           - id: "check_prostituicao"
#             cls: "px-2 py-0"
#             type: "check"
#             label: "Prostituição"
#             value: false
#             color: "accent"
#             selection:
#               event: "selection" 
#               rules:
#                 filter: ",and,eq-spai_id_prostituicao_adulto-'Sim'"
#                 filter_text: "com prostituição"
#           - id: "check_alcool"
#             cls: "px-2 py-0"
#             type: "check"
#             label: "Consumo de bebida alcóolica"
#             value: false
#             color: "accent"
#             selection:
#               event: "selection" 
#               rules:
#                 filter: ",and,eq-spai_id_ponto_consumo_alcool -'Sim'"
#                 filter_text: "com consumo de bebida alcóolica"
#           - id: "check_penumbra"
#             cls: "px-2 py-0"
#             type: "check"
#             label: "Penumbra"
#             value: false
#             color: "accent"
#             selection:
#               event: "selection" 
#               rules:
#                 filter: ",and,eq-spai_id_iluminacao_area-'Penumbra'"
#                 filter_text: "com pouca iluminação(Penumbra)"
#         chart_type: "TREEMAP"
#         api: 
#           template: "/ti/mapear?categorias=spai_ds_classific&agregacao=count&ordenacao=-agr_count&filtros=eq-cd_uf-{0},and,eq-nu_competencia-nu_competencia_max"
#           args:
#             - named_prop: "idLocalidade"
#         headers:
#           - text: 'Característica principal'
#             align: 'left'
#             value: 'spai_ds_classific'
#           - text: 'Qtde'
#             value: 'agr_count'
#         chart_options:
#           id: "spai_ds_classific"
#           text: "spai_ds_classific"
#           size: "agr_count"
#           colorScale:
#             name: "BuGn"
#             type: "singleHue"
#             levels: 5
#             order: 'asc'
# ========================================================
      - id: "treemap_conc_pontos_area"
        title:
          fixed: "Concentração de Pontos Vulneráveis monitorados por Área"
        title_comment:
          template: "{0}"
          args:
            - base_object: "localidade"
              named_prop: "nm_localidade"
        description: 
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12 md6'
                api:
                  template: "/ti/mapear?categorias=ds_area-cd_indicador&agregacao=count&filtros=eq-nu_competencia-nu_competencia_max,and,eq-cd_uf-{0}"
                  args:
                    - named_prop: "idLocalidade"
                  options:
                    combine:
                      - id: "perc_urbana"
                        desc: "% Urbana"
                        function: 'calc_percentage_val1'
                        fn_args:
                          - id: "Urbana"
                            named_prop: "agr_count"
                          - id: "Rural"
                            named_prop: "agr_count"
                args:
                  - id: "perc_urbana"
                    prop: "value"
                    named_prop: 'vl_indicador'
                    format: "porcentagem"
                    precision: 0
                  - prop: "description"
                    fixed: "Urbana"
                  - id: "Urbana"
                    prop: "comment"
                    named_prop: 'agr_count'
                    format: "inteiro"
              - relevance: 'high'
                cls: 'xs12 md6'
                api:
                  template: "/ti/mapear?categorias=ds_area-cd_indicador&agregacao=count&filtros=eq-nu_competencia-nu_competencia_max,and,eq-cd_uf-{0}"
                  args:
                    - named_prop: "idLocalidade"
                  options:
                    combine:
                      - id: "perc_rural"
                        desc: "% Rural"
                        function: 'calc_percentage_val1'
                        fn_args:
                          - id: "Rural"
                            named_prop: "agr_count"
                          - id: "Urbana"
                            named_prop: "agr_count"
                args:
                  - id: "perc_rural"
                    prop: "value"
                    named_prop: 'vl_indicador'
                    format: "porcentagem"
                    precision: 0
                  - prop: "description"
                    fixed: "Rural"
                  - id: "Rural"
                    prop: "comment"
                    named_prop: 'agr_count'
                    format: "inteiro"
          - type: "text"
            title: ""
            content:
              fixed: "Em destaque, de acordo com a perspectiva geográfica selecionada, a distribuição do tipo de área em que os pontos de vulnerabilidade foram localizados (rural ou urbana). No gráfico ao lado, apresenta-se a concentração percentual dessas áreas."
          - id: "select_risco_treemap_rodovia"
            type: "select"
            label: "Grau de Risco de Exploração"
            api:
              fixed: "/ti/mapear?categorias=spai_ds_risco_nivel&agregacao=distinct&filtros=eq-nu_competencia-nu_competencia_max"
            args:
              - prop: "id"
                named_prop: "spai_ds_risco_nivel"
              - prop: "label"
                named_prop: "spai_ds_risco_nivel"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_ds_risco_nivel-'{0}'"
                api:
                  args:
                    - named_prop: "spai_ds_risco_nivel"
          - id: "check_con_tutelar"
            title: "Características Confirmadas:"
            cls: "px-2 py-0"
            type: "check"
            label: "Ausência de Atuação do Conselho Tutelar Reportada"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_atua_conselho_tutelar-'Sim'"
                filter_text: "com ausência de atuação do Conselho Tutelar Reportada"
          - id: "check_drogas"
            cls: "px-2 py-0"
            type: "check"
            label: "Consumo de Drogas Identificado"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_reg_traf_consumo_droga-'Sim'"
                filter_text: "com consumo de drogas identificado"
          - id: "check_prostituicao"
            cls: "px-2 py-0"
            type: "check"
            label: "Pontos de prostituição"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_prostituicao_adulto-'Sim'"
                filter_text: "com pontos de prostituição"
          - id: "check_alcool"
            cls: "px-2 py-0"
            type: "check"
            label: "Consumo de Bebidas Alcóolicas Identificado"
            value: false
            color: "accent"
            selection:
              event: "selection" 
              rules:
                filter: ",and,eq-spai_id_ponto_consumo_alcool -'Sim'"
                filter_text: "com consumo de bebida alcóolica identificado"
          # - id: "check_penumbra"
          #   cls: "px-2 py-0"
          #   type: "check"
          #   label: "Penumbra"
          #   value: false
          #   color: "accent"
          #   selection:
          #     event: "selection" 
          #     rules:
          #       filter: ",and,eq-spai_id_iluminacao_area-'Penumbra'"
          #       filter_text: "com pouca iluminação(Penumbra)"
        chart_type: "TREEMAP"
        api: 
          template: "/ti/mapear?categorias=ds_area&agregacao=count&filtros=eq-nu_competencia-nu_competencia_max,and,eq-cd_uf-{0}"
          args:
            - named_prop: "idLocalidade"
        headers:
          - text: 'Área'
            align: 'left'
            value: 'ds_area'
          - text: 'Qtde'
            value: 'agr_count'
        chart_options:
          id: "ds_area"
          text: "ds_area"
          size: "agr_count"
          colorScale:
            name: "BuGn"
            type: "singleHue"
            levels: 5
            order: 'asc'
