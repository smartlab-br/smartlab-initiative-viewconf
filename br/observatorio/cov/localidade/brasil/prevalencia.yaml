principais:
  - relevance: 'lead' 
    cls: 'xs12 xl6'
    rowClass: "pt-0 px-3 pb-5"
    api: 
      fixed: "/thematic/casoscovid19?categorias=1&valor=last_available_date,last_available_confirmed&agregacao=MAX,SUM&filtros=eq-place_type-'state',and,eq-is_last-TRUE"
    args:
      - prop: "value"
        named_prop: 'agr_sum_last_available_confirmed'
        format: 'inteiro'
        default: 'Nenhum'
        zero: 'Nenhum'
      - prop: "description"
        fixed: "Casos Confirmados"
      - prop: 'comment'
        named_prop: 'agr_max_last_available_date'
        format: 'dataDMY'
  - relevance: 'lead' 
    cls: 'xs12 xl6'
    rowClass: "pt-0 px-3 pb-5"
    api: 
      fixed: "/thematic/casoscovid19?categorias=1&valor=last_available_date,last_available_deaths&agregacao=MAX,SUM&filtros=eq-place_type-'state',and,eq-is_last-TRUE"
    args:
      - prop: "value"
        named_prop: 'agr_sum_last_available_deaths'
        format: 'inteiro'
        default: 'Nenhum'
        zero: 'Nenhum'
      - prop: "description"
        fixed: "Óbitos Confirmados"
      - prop: 'comment'
        named_prop: 'agr_max_last_available_date'
        format: 'dataDMY'
  - relevance: "lead"
    cls: 'xs12 xl6'
    rowClass: "pt-0 px-3 pb-5"
    api: 
      fixed: "/thematic/casoscovid19?categorias=1&valor=cd_municipio_ibge_dv,last_available_date,estimated_population_2019&agregacao=COUNT,MAX,SUM&filtros=eq-place_type-'city',and,eq-is_last-TRUE"
    args:
      - prop: "value"
        named_prop: "agr_count_cd_municipio_ibge_dv"
        format: 'inteiro'
      - prop: "description"
        fixed: "Municípios atingidos"
      - prop: 'comment'
        template: "{0}% de um total de 5.570 municípios <br/>
                   {1}% da população brasileira"
        args:
          - function: 'calc_percentage'
            format: 'inteiro'
            fn_args:
              - named_prop: "agr_count_cd_municipio_ibge_dv"
              - fixed: 5570
          - function: 'calc_percentage'
            format: 'inteiro'
            fn_args:
              - named_prop: "agr_sum_estimated_population_2019"
              - fixed: 210147125
  - relevance: "lead"
    cls: 'xs12 xl6'
    rowClass: "pt-0 px-3 pb-5"
    api: 
      fixed: "/thematic/casoscovid19?categorias=1&valor=cd_municipio_ibge_dv,last_available_date,estimated_population_2019&agregacao=COUNT,MAX,SUM&filtros=eq-place_type-'city',and,eq-is_last-TRUE,and,ne-last_available_deaths-0"
    args:
      - prop: "value"
        named_prop: "agr_count_cd_municipio_ibge_dv"
        format: 'inteiro'
      - prop: "description"
        fixed: "Municípios com óbitos"
      - prop: 'comment'
        template: "{0}% de um total de 5.570 municípios <br/>
                   {1}% da população brasileira"
        args:
          - function: 'calc_percentage'
            format: 'inteiro'
            fn_args:
              - named_prop: "agr_count_cd_municipio_ibge_dv"
              - fixed: 5570
          - function: 'calc_percentage'
            format: 'inteiro'
            fn_args:
              - named_prop: "agr_sum_estimated_population_2019"
              - fixed: 210147125
# ========================================================
secoes:
  - id: 'prevalencia_geografico'
    name: 'Contexto Geográfico'
    cards:
# ========================================================
      - id: "mapa_casos"
        title: 
          fixed: "Distribuição Geográfica por UF"
        title_comment:
          template: "Brasil, {0}"
          api: 
            fixed: "/thematic/casoscovid19?categorias=1&valor=last_available_date&agregacao=MAX&filtros=eq-place_type-'state',and,eq-is_last-TRUE"
          args:
            - named_prop: "agr_max_last_available_date"
              format: 'dataDMY'
        # info:
        #   - type: "text"
        #     title: "Sobre a métrica"
        #     content:
        #       fixed: ""
        description:
          - type: "minicards"
            cards:
              - relevance: 'high'
                cls: 'xs12 md6'
                api: 
                  fixed: "/thematic/casoscovid19?categorias=1&valor=last_available_date,last_available_confirmed&agregacao=MAX,SUM&filtros=eq-place_type-'state',and,eq-is_last-TRUE"
                args:
                  - prop: "value"
                    named_prop: 'agr_sum_last_available_confirmed'
                    format: 'inteiro'
                    default: "Sem Registros"
                    zero: "Nenhum"
                  - prop: "description"
                    fixed: 'Casos confirmados'
              - relevance: 'high'
                cls: 'xs12 md6'
                api: 
                  fixed: "/thematic/casoscovid19?categorias=1&valor=last_available_date,last_available_deaths&agregacao=MAX,SUM&filtros=eq-place_type-'state',and,eq-is_last-TRUE"
                args:
                  - prop: "value"
                    named_prop: 'agr_sum_last_available_deaths'
                    format: 'inteiro'
                    default: "Sem Registros"
                    zero: "Nenhum"
                  - prop: "description"
                    fixed: 'Óbitos confirmados'
          - type: "text"
            title: ""
            content:
              fixed: "Em destaque, o número de casos confirmados.<br/>"
          - id: "covid_valor"
            type: "radio"
            items:
              - id: "casos"
                value: "last_available_confirmed"
                default: true
                color: "light-blue"
                label: "CASOS CONFIRMADOS"
              - id: "obitos"
                value: "last_available_deaths"
                color: "red"
                label: "ÓBITOS CONFIRMADOS"
              - id: "casos100M"
                value: "last_available_confirmed_per_100k_inhabitants"
                color: "green accent-4"
                label: "CASOS CONFIRMADOS/100.000 hab."
              - id: "obitos100M"
                value: "last_available_death_rate"
                color: "purple"
                label: "ÓBITOS CONFIRMADOS/100.000 hab."
            selection:
              event: 'selection'
              rules:
                api:
                  template: "/thematic/casoscovid19?categorias={0}-valor,estimated_population_2019,cd_uf,nm_uf,last_available_date,last_available_confirmed,last_available_deaths,last_available_confirmed_per_100k_inhabitants,last_available_death_rate&filtros=eq-place_type-'state',and,eq-is_last-TRUE"
                  args:
                    - named_prop: "covid_valor"
        chart_type: "MAP_TOPOJSON"
        api: 
          fixed: "/thematic/casoscovid19?categorias=last_available_confirmed-valor,estimated_population_2019,cd_uf,nm_uf,last_available_date,last_available_confirmed,last_available_deaths,last_available_confirmed_per_100k_inhabitants,last_available_death_rate&filtros=eq-place_type-'state',and,eq-is_last-TRUE"
          options:
            calcs:
              - id: "deviation_casos"
                function: "get_log"
                fn_args:
                  - fixed: "valor"
            formatters:
              - id: "estimated_population_2019"
                format: 'inteiro'
              - id: "last_available_deaths"
                format: 'inteiro'
              - id: "last_available_confirmed"
                format: 'inteiro'
              - id: "last_available_confirmed_per_100k_inhabitants"
                format: 'real'
                precision: 2
              - id: "last_available_death_rate"
                format: 'real'
                precision: 2
              - id: "last_available_date"
                format: 'dataDMY'
        headers:
          - text: 'UF'
            align: 'left'
            value: 'nm_uf'
          - text: 'População estimada (2019)'
            value: 'fmt_estimated_population_2019'
          - text: 'Casos confirmados'
            value: 'fmt_last_available_confirmed'
          - text: 'Óbitos confirmados'
            value: 'fmt_last_available_deaths'
          - text: 'Casos confirmados/100.000 hab.'
            value: 'fmt_last_available_confirmed_per_100k_inhabitants'
          - text: 'Óbitos confirmados/100.000 hab.'
            value: 'fmt_last_available_death_rate'
          - text: 'Data coleta'
            value: 'fmt_last_available_date'
        chart_options:
          id_field: 'cd_uf'
          topo_key: "codigo"
          value_field: 'calc_deviation_casos'
          colorScale: 
            type: "singleHue"
            scale_name_value: "covid_valor"
            color_array: 
              "last_available_confirmed": "Blues"
              "last_available_deaths": "Reds"
              "last_available_confirmed_per_100k_inhabitants": "Greens"
              "last_available_death_rate": "Purples"
          # colorScale:
          #   name: 'Reds'
# ========================================================
      - id: "mapa_casos_regic"
        title: 
          fixed: "Distribuição Geográfica por Região de Saúde"
        title_comment:
          template: "Brasil, {0}"
          api: 
            template: "/thematic/arranjoregic?categorias=dt_coleta_covid_arranjo&filtros=nn-cd_municipio_ibge_dv_alta_complex&limit=1"
          args:
            - named_prop: "dt_coleta_covid_arranjo"
              format: "dataDMY"
        # info:
        #   - type: "text"
        #     title: "Sobre a métrica"
        #     content:
        #       fixed: ""
        description:
          - type: "text"
            title: ""
            content:
              fixed: "Texto...<br/>"
          - id: "covid_valor"
            type: "radio"
            items:
              - id: "casos"
                value: "qt_casos_covid_arranjo"
                default: true
                color: "light-blue"
                label: "CASOS CONFIRMADOS"
              - id: "obitos"
                value: "qt_mortes_covid_arranjo"
                color: "red"
                label: "ÓBITOS CONFIRMADOS"
            selection:
              event: 'selection'
              rules:
                api:
                  template: "/thematic/arranjoregic?categorias=latitude_alta_complex-lat,longitude_alta_complex-long,{0}-valor,populacao_arranjo,qt_municipios_arranjo,dt_coleta_covid_arranjo,qt_casos_covid_arranjo,qt_mortes_covid_arranjo,nm_municipio_uf_alta_complex-target_mun,cd_municipio_ibge_alta_complex-target_cd_mun,cd_municipio_ibge_dv_alta_complex-cd_mun_ibge&agregacao=DISTINCT"
                  args:
                    - named_prop: "covid_valor"
        chart_type: "MAP_POLYGON"
        api: 
          template: "/thematic/arranjoregic?categorias=latitude_alta_complex-lat,longitude_alta_complex-long,qt_casos_covid_arranjo-valor,populacao_arranjo,qt_municipios_arranjo,dt_coleta_covid_arranjo,qt_casos_covid_arranjo,qt_mortes_covid_arranjo,nm_municipio_uf_alta_complex-target_mun,cd_municipio_ibge_alta_complex-target_cd_mun,cd_municipio_ibge_dv_alta_complex-cd_mun_ibge&agregacao=DISTINCT"
          options:
            calcs:
              - id: "deviation_valor"
                function: "get_log"
                fn_args:
                  - fixed: "valor"
            formatters:
              - id: "populacao_arranjo"
                format: "inteiro"
              - id: "populacao_arranjo"
                format: "inteiro"
              - id: "qt_casos_covid_arranjo"
                format: "inteiro"
              - id: "qt_mortes_covid_arranjo"
                format: "inteiro"
              - id: "dt_coleta_covid_arranjo"
                format: "dataDMY"
        headers:
          - text: 'Arranjo Populacional'
            align: 'left'
            value: 'target_mun'
          - text: 'Municípios atendidos'
            value: 'qt_municipios_arranjo'
          - text: 'População atendida'
            value: 'fmt_populacao_arranjo'
          - text: 'Casos confirmados'
            value: 'fmt_qt_casos_covid_arranjo'
          - text: 'Óbitos confirmados'
            value: 'fmt_qt_mortes_covid_arranjo'
          - text: 'Data coleta'
            value: 'fmt_dt_coleta_covid_arranjo'
        chart_options:
          id_field: 'cd_mun_ibge'
          topo_key: "CodReg"
          value_field: 'calc_deviation_valor'
          tooltip_function: 'obsCovidRegicTooltip'
          lat: "lat"
          long: "long"
          topology:
            scope: "regic"
            range: "br"
          colorScale: 
            type: "singleHue"
            scale_name_value: "covid_valor"
            color_array: 
              "qt_casos_covid_arranjo": "Blues"
              "qt_mortes_covid_arranjo": "Reds"
          # colorScale:
          #   name: 'Reds'
# ========================================================
      - id: "mapa_prev_brasil"
        chart_type: "MAP_BUBBLES"
        title: 
          fixed: "Distribuição Geográfica por Município"
        title_comment:
          template: "Brasil, {0}"
          api: 
            fixed: "/thematic/casoscovid19?categorias=1&valor=last_available_date&agregacao=MAX&filtros=eq-place_type-'state',and,eq-is_last-TRUE"
          args:
            - named_prop: "agr_max_last_available_date"
              format: 'dataDMY'
        # info:
        #   - type: "text"
        #     title: "Sobre"
        #     content:
        #       fixed: ""
        api:
        # &calcs=ln_norm_pos_part&partition=cd_municipio_ibge_dv
          - fixed: "/thematic/casoscovid19?categorias=cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio_uf,'casos'-codigo,last_available_date,last_available_deaths,last_available_confirmed_per_100k_inhabitants,last_available_death_rate,last_available_confirmed-valor,latitude,longitude&valor=last_available_confirmed&calcs=ln_norm_pos_part&partition=is_last&filtros=eq-place_type-'city',and,eq-is_last-TRUE,and,ne-latitude-0,and,ne-longitude-0"
          - fixed: "/thematic/casoscovid19?categorias=cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio_uf,'obitos'-codigo,last_available_date,last_available_confirmed,last_available_confirmed_per_100k_inhabitants,last_available_death_rate,last_available_deaths-valor,latitude,longitude&valor=last_available_deaths&calcs=ln_norm_pos_part&partition=is_last&filtros=eq-place_type-'city',and,eq-is_last-TRUE,and,ne-latitude-0,and,ne-longitude-0"
          # - fixed: "/thematic/casoscovid19?categorias=cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio_uf,'conf100M'-codigo,last_available_date,last_available_confirmed,last_available_deaths,last_available_death_rate,last_available_confirmed_per_100k_inhabitants-valor,latitude,longitude&valor=last_available_confirmed_per_100k_inhabitants&calcs=ln_norm_pos_part&partition=is_last&filtros=eq-place_type-'city',and,eq-is_last-TRUE,and,ne-latitude-0,and,ne-longitude-0"
          # - fixed: "/thematic/casoscovid19?categorias=cd_municipio_ibge_dv-cd_mun_ibge,nm_municipio_uf,'obitos100M'-codigo,last_available_date,last_available_confirmed,last_available_deaths,last_available_confirmed_per_100k_inhabitants,last_available_death_rate-valor,latitude,longitude&valor=last_available_death_rate&calcs=ln_norm_pos_part&partition=is_last&filtros=eq-place_type-'city',and,eq-is_last-TRUE,and,ne-latitude-0,and,ne-longitude-0"
        chart_options:
          colorArray: ["rgba(179, 9, 0, 0.7)", "rgba(21, 101, 192, 0.7)", "rgba(25, 125, 25, 0.7)", "#9C27B0"]
          indicadores: ["obitos","casos","conf100M", "obitos100M"]
          lat: 'latitude'
          long: 'longitude'
          id_field: 'codigo' 
          clickable: true
          height_proportion: 1
          radius:
            base: 10000
            multiplier: 800000
          tiles_url: "https://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}"
          tiles_attribution: "Tiles &copy; Esri &mdash; Source: Esri, DeLorme, NAVTEQ, USGS, Intermap, iPC, NRCAN, Esri Japan, METI, Esri China (Hong Kong), Esri (Thailand), TomTom, 2012"
        headers:
          - text: 'Município'
            value: 'nm_municipio_uf'
          - text: 'Casos confirmados'
            value: 'last_available_confirmed'
            format: 'inteiro'
          - text: 'Óbitos confirmados'
            value: 'last_available_deaths'
            format: 'inteiro'
          - text: 'Casos confirmados/100.000 hab.'
            value: 'last_available_confirmed_per_100k_inhabitants'
            format: 'real'
            precision: 2
          - text: 'Óbitos confirmados/100.000 hab.'
            value: 'last_available_death_rate'
            format: 'real'
            precision: 2
          - text: 'Data coleta'
            value: 'last_available_date'
            format: 'dataDMY'
        source:
          desc: "fonte"
          link: ""
        description:
          - type: "text"
            title: ""
            content:
              fixed: "Texto..."
          - id: "selectlayer"
            type: "switch-group"
            switches:
              - id: "casos"
                default: true
                color: "light-blue"
                label: "CASOS CONFIRMADOS"
              - id: "obitos"
                default: true
                color: "red"
                label: "ÓBITOS CONFIRMADOS"
              # - id: "conf100M"
              #   default: false
              #   color: "green accent-4"
              #   label: "CASOS CONFIRMADOS/100.000 hab."
              # - id: "obitos100M"
              #   default: false
              #   color: "purple"
              #   label: "ÓBITOS CONFIRMADOS/100.000 hab."
            event: 'selection'
# ========================================================
      - id: "mapa_prev_brasil_calor"
        chart_type: "MAP_HEAT"
        title: 
          fixed: "Mapa de Calor"
        title_comment:
          template: "Brasil, {0}"
          api: 
            fixed: "/thematic/casoscovid19?categorias=1&valor=last_available_date&agregacao=MAX&filtros=eq-place_type-'state',and,eq-is_last-TRUE"
          args:
            - named_prop: "agr_max_last_available_date"
              format: 'dataDMY'
        # info:
        #   - type: "text"
        #     title: "Sobre"
        #     content:
        #       fixed: ""
        api:
          - fixed: "/thematic/casoscovid19?categorias=cd_municipio_ibge_dv,nm_municipio_uf,'casos'-cd_indicador,last_available_date,last_available_deaths,last_available_confirmed_per_100k_inhabitants,last_available_death_rate,last_available_confirmed-vl_indicador,latitude,longitude&valor=last_available_confirmed&calcs=ln_norm_pos_part&partition=is_last&filtros=eq-place_type-'city',and,eq-is_last-TRUE,and,ne-latitude-0,and,ne-longitude-0"
          - fixed: "/thematic/casoscovid19?categorias=cd_municipio_ibge_dv,nm_municipio_uf,'obitos'-cd_indicador,last_available_date,last_available_confirmed,last_available_confirmed_per_100k_inhabitants,last_available_death_rate,last_available_deaths-vl_indicador,latitude,longitude&valor=last_available_deaths&calcs=ln_norm_pos_part&partition=is_last&filtros=eq-place_type-'city',and,eq-is_last-TRUE,and,ne-latitude-0,and,ne-longitude-0"
        chart_options:
          colorArray: ["rgba(21, 101, 192, 0.7)", "rgba(179, 9, 0, 0.7)"]
          height_proportion: 1
          indicadores: ["casos","obitos"]
          lat: 'latitude'
          long: 'longitude'
          value_field: 'vl_indicador'
        source:
          desc: ""
          link: ""
        description:
          - type: "text"
            title: ""
            content:
              fixed: "Texto..."
          - id: "selectlayer"
            type: "radio"
            items:
              - id: "casos"
                cls: "xs12"
                label: "Casos confirmados"
                color: "light-blue"
                value: "casos"
                default: true
              - id: "obitos"
                cls: "xs12"
                label: "Óbitos confirmados"
                color: "red"
                value: "obitos"
            event: 'selection'
# # ========================================================
#       - id: "mapa_prev_brasil_cluster"
#         chart_type: "MAP_CLUSTER"
#         title: 
#           fixed: "Mapa de agrupamentos de municípios próximos"
#         title_comment:
#           template: "Brasil, {0} a {1}"
#           api: 
#             fixed: "/te/indicadoresnacionais?categorias=nu_competencia_min,nu_competencia_max&limit=1&filtros=eq-cd_indicador-'te_rgt'"
#           args:
#             - named_prop: "nu_competencia_min"
#             - named_prop: "nu_competencia_max"
#         info:
#           - type: "text"
#             title: "Sobre"
#             content:
#               fixed: "O total de resgates foi calculado com base em informações extraídas do Banco de Dados COETE (MTb), que inclui beneficiários e não-beneficiários do Seguro-Desemprego modalidade trabalhador resgatado. O total de egressos com naturalidade e residência declaradas foi calculado com base nos registros administrativos do seguro-desemprego nessa modalidade, isto é, restringe-se aos trabalhadores habilitados ao recebimento do benefício. Diferenças entre os números se explicam por padrões de lançamento desses dados e pelas normas referentes à concessão do benefício vigentes. Entre 1995 a 2017, foram contabilizados mais de 50 mil resgates. Por sua maior consistência, este Observatório analisou dados desde 2003 (ano de lançamento do I Plano Nacional de Erradicação do Trabalho Escravo)."
#         api:
#           fixed: "/te/indicadoresmunicipais?categorias=latitude,longitude,cd_mun_ibge,nm_municipio,cd_indicador&valor=vl_indicador&agregacao=sum&filtros=nn-vl_indicador,and,in-cd_indicador-'te_rgt'-'te_nat'-'te_res'&calcs=ln_norm_pos_part"
#         chart_options:
#           colorArray: ["rgba(25, 125, 25, 0.7)", "rgba(179, 9, 0, 0.7)", "rgba(21, 101, 192, 0.7)"]
#           height_proportion: 1
#           indicadores: ["te_rgt","te_nat","te_res"]
#           lat: 'latitude'
#           long: 'longitude'
#           tooltip_function: 'obsTETooltip'
#         source:
#           desc: "Bancos de dados do Seguro-Desemprego do Trabalhador Resgatado, do Sistema de Acompanhamento do Trabalho Escravo (SISACTE) e do Sistema COETE (Controle de Erradicação do Trabalho Escravo), referentes ao período iniciado em 2003 (Primeiro Plano Nacional de Erradicação do Trabalho Escravo). Os dados brutos foram fornecidos pelo Ministério da Economia do Brasil."
#           link: ""
#         description:
#           - type: "text"
#             title: ""
#             content:
#               fixed: "O mapa ao lado apresenta agrupamentos de municípios (clusters) conforme a distribuição espacial de localidades de resgates, naturalidade e residência declarada de egressos, conforme a seleção abaixo."
#           - id: "selectlayer"
#             type: "radio"
#             items:
#               - id: "te_rgt"
#                 cls: "xs12"
#                 label: "Resgates"
#                 value: "te_rgt"
#                 color: "green accent-4"
#               - id: "te_nat"
#                 cls: "xs12"
#                 label: "Naturalidade Apurada"
#                 color: "red"
#                 value: "te_nat"
#               - id: "te_res"
#                 cls: "xs12"
#                 label: "Residência Apurada"
#                 color: "light-blue"
#                 value: "te_res"
#             event: 'selection'
# ========================================================
      - id: "mapa_alta_complex"
        chart_type: "MAP_MIGRATION"
        title: 
          fixed: "Leitos de UTI / 10.000 hab. - Situação nos Pólos de Atendimento de Alta Complexidade"
        title_comment:
          template: "Brasil, em {0}/{1}"
          api: 
            fixed: "/thematic/arranjoregic?categorias=cnes_ano_refencia,cnes_mes_referencia&limit=1"
          args:
            - named_prop: "cnes_mes_referencia"
            - named_prop: "cnes_ano_refencia"


        # info:
        #   - type: "text"
        #     title: "Sobre"
        #     content:
        #       fixed: ""
        description:
          - type: "text"
            title: ""
            content:
              fixed: "Texto..."
          - id: "select_uf"
            type: "select"
            label: "Unidade Federativa"
            clearable: false
            default: 
              fixed: 35 # São Paulo como default
            target: 
              range: "uf"
              scope: "municipio"
            api:
              fixed: "/municipios?categorias=cd_uf,nm_uf&agregacao=distinct&ordenacao=nm_uf&filtros=eq-1-1"
            args:
              - prop: "id"
                named_prop: "cd_uf"
              - prop: "label"
                named_prop: "nm_uf"
            selection:
              event: "selection"
              rules:
                api: 
                  - template: "/thematic/arranjoregic?categorias=proporcao_leitos_uti_10k_arranjo,nm_municipio_uf_origem-source_mun,nm_municipio_alta_complex-target_mun,cd_municipio_ibge_origem-source_cd_mun,cd_municipio_ibge_alta_complex-target_cd_mun,latitude_origem-source_lat,latitude_alta_complex-target_lat,longitude_origem-source_long,longitude_alta_complex-target_long&filtros=eq-cd_uf_origem-{0},and,ne-cd_municipio_ibge_origem-cd_municipio_ibge_alta_complex"
                    args:
                      - named_prop: "cd_uf"
                  - template: "/thematic/arranjoregic?categorias=proporcao_leitos_uti_10k_arranjo,nm_municipio_uf_origem-source_mun,nm_municipio_alta_complex-target_mun,cd_municipio_ibge_origem-source_cd_mun,cd_municipio_ibge_alta_complex-target_cd_mun,latitude_origem-source_lat,latitude_alta_complex-target_lat,longitude_origem-source_long,longitude_alta_complex-target_long&filtros=ne-cd_uf_origem-{0},and,eq-cd_uf_alta_complex-{0},and,ne-cd_municipio_ibge_origem-cd_municipio_ibge_alta_complex"
                    args:
                      - named_prop: "cd_uf"
        api: 
          - fixed: "/thematic/arranjoregic?categorias=proporcao_leitos_uti_10k_arranjo,nm_municipio_uf_origem-source_mun,nm_municipio_alta_complex-target_mun,cd_municipio_ibge_origem-source_cd_mun,cd_municipio_ibge_alta_complex-target_cd_mun,latitude_origem-source_lat,latitude_alta_complex-target_lat,longitude_origem-source_long,longitude_alta_complex-target_long&filtros=eq-cd_uf_origem-35,and,ne-cd_municipio_ibge_origem-cd_municipio_ibge_alta_complex"
            options:
              calcs:
                - id: 'uti_level'
                  function: 'get_uti_level'
                  fn_args:
                    - named_prop: 'proporcao_leitos_uti_10k_arranjo'
          - fixed: "/thematic/arranjoregic?categorias=proporcao_leitos_uti_10k_arranjo,nm_municipio_uf_origem-source_mun,nm_municipio_alta_complex-target_mun,cd_municipio_ibge_origem-source_cd_mun,cd_municipio_ibge_alta_complex-target_cd_mun,latitude_origem-source_lat,latitude_alta_complex-target_lat,longitude_origem-source_long,longitude_alta_complex-target_long&filtros=ne-cd_uf_origem-35,and,eq-cd_uf_alta_complex-35,and,ne-cd_municipio_ibge_origem-cd_municipio_ibge_alta_complex"
            options:
              calcs:
                - id: 'uti_level'
                  function: 'get_uti_level'
                  fn_args:
                    - named_prop: 'proporcao_leitos_uti_10k_arranjo'
        headers:
          - text: 'Município origem'
            align: 'left'
            value: 'source_mun'
          - text: 'Destino para Atendimento de Alta Complexidade'
            align: 'left'
            value: 'target_mun'
        chart_options:
          id_field: 'calc_uti_level'
          value_field: 'agr_count'
          loc_size_field: 'agr_count'
          show_markers: true
          radius:
            base: 10000
            multiplier: 2000
          path:
            multiplier: 4
            animation:
              base_duration: 10000
          source:
            lat: 'source_lat'
            long: 'source_long'
            id: 'source_cd_mun'
          target:
            lat: 'target_lat'
            long: 'target_long'
            id: 'target_cd_mun'
            tooltip_function: 'obsCovidRegicTooltip'
            # tooltip_items:
            #   - text: 'Pólo Alta Complexidade'
            #     value: 'target_mun'
            #   # - text: 'População Estimada'
            #   #   value: 'fmt_estimaded_population'
          indicadores: ['Abaixo do recomendado','Dentro do recomendado','Acima do recomendado']
          legendArray: ['Abaixo do recomendado','Dentro do recomendado','Acima do recomendado']
          colorArray: ["rgba(179, 9, 0, 0.7)","#fbc11a","green"]
        source:
          desc: "fonte"
          link: ""
# ========================================================
      - id: "topo_alta_complex_uti_regic"
        chart_type: "MAP_POLYGON"
        title: 
          fixed: "Leitos de UTI / 10.000 hab. - Situação nos Pólos de Atendimento de Alta Complexidade"
        title_comment:
          template: "Brasil, em {0}/{1}"
          api: 
            fixed: "/thematic/arranjoregic?categorias=cnes_ano_refencia,cnes_mes_referencia&limit=1"
          args:
            - named_prop: "cnes_mes_referencia"
            - named_prop: "cnes_ano_refencia"
        # info:
        #   - type: "text"
        #     title: "Sobre"
        #     content:
        #       fixed: ""
        description:
          # - type: "minicards"
          #   cards:
          #     - relevance: 'low'
          #       cls: 'xs12 md6'
          #       api: 
          #         template: "/thematic/arranjoregic?categorias=qt_leitos_uti_arranjo&filtros=eq-cd_municipio_ibge_origem-{0}"
          #         args:
          #           - named_prop: "idLocalidadeD6"
          #       args:
          #         - prop: "value"
          #           named_prop: 'qt_leitos_uti_arranjo'
          #           format: 'inteiro'
          #           default: "Sem Registros"
          #           zero: "Nenhum"
          #         - prop: "description"
          #           fixed: 'Número de Leitos de UTI'
          #     - relevance: 'low'
          #       cls: 'xs12 md6'
          #       api: 
          #         template: "/thematic/arranjoregic?categorias=proporcao_leitos_uti_10k_arranjo&filtros=eq-cd_municipio_ibge_origem-{0}"
          #         args:
          #           - named_prop: "idLocalidadeD6"
          #       args:
          #         - prop: "value"
          #           named_prop: 'proporcao_leitos_uti_10k_arranjo'
          #           format: 'real'
          #           default: "Sem Registros"
          #           zero: "Nenhum"
          #         - prop: "description"
          #           fixed: 'Número de Leitos de UTI'
          #         - prop: "comment"
          #           fixed: 'por 10.000 hab.'
          - type: "text"
            title: ""
            content:
              fixed: "Texto..."
          - id: "select_uf"
            type: "select"
            label: "Unidade Federativa"
            clearable: false
            default: 
              fixed: 35 # São Paulo como default
            target: 
              range: "uf"
              scope: "regic"
            api:
              fixed: "/municipios?categorias=cd_uf,nm_uf&agregacao=distinct&ordenacao=nm_uf&filtros=eq-1-1"
            args:
              - prop: "id"
                named_prop: "cd_uf"
              - prop: "label"
                named_prop: "nm_uf"
            selection:
              event: "selection"
              rules:
                api: 
                  template: "/thematic/arranjoregic?categorias=qt_leitos_uti_arranjo,proporcao_leitos_uti_10k_arranjo,nm_municipio_uf_alta_complex-target_mun,cd_municipio_ibge_alta_complex-target_cd_mun,cd_municipio_ibge_dv_alta_complex-cd_mun_ibge,latitude_alta_complex-lat,longitude_alta_complex-long&agregacao=DISTINCT&filtros=eq-cd_uf_origem-{0},and,nn-cd_municipio_ibge_dv_alta_complex"
                  args:
                    - named_prop: "cd_uf"
        api: 
          fixed: "/thematic/arranjoregic?categorias=qt_leitos_uti_arranjo,proporcao_leitos_uti_10k_arranjo,nm_municipio_uf_alta_complex-target_mun,cd_municipio_ibge_alta_complex-target_cd_mun,cd_municipio_ibge_dv_alta_complex-cd_mun_ibge,latitude_alta_complex-lat,longitude_alta_complex-long&agregacao=DISTINCT&filtros=eq-cd_uf_origem-35,and,nn-cd_municipio_ibge_dv_alta_complex"
          options:
            recalc_min_max: true
            minmax_field: "proporcao_leitos_uti_10k_arranjo"
            calcs:
              - id: 'uti_level'
                function: 'get_uti_level'
                fn_args:
                  - named_prop: 'proporcao_leitos_uti_10k_arranjo'
              - id: "deviation"
                function: "get_bipolar_scale"
                fn_args: 
                  - fixed: 'proporcao_leitos_uti_10k_arranjo'
                  - fixed: 2
        headers:
          - text: 'Município origem'
            align: 'left'
            value: 'source_mun'
          - text: 'População estimada (2019)'
            value: 'populacao_estimada_mun_origem'
            format: 'inteiro'
          - text: 'Pólo Destino para Atendimento de Alta Complexidade'
            align: 'left'
            value: 'target_mun'
          - text: 'Qtd Leitos UTI no Pólo'
            value: 'qt_leitos_uti_arranjo'
            format: 'inteiro'
          - text: 'Leitos UTI/10.000 hab. no Pólo'
            value: 'proporcao_leitos_uti_10k_arranjo'
            format: 'real'
          - text: 'Situação no Pólo'
            value: 'calc_uti_level'
        chart_options:
          id_field: 'cd_mun_ibge'
          lat: 'lat'
          long: 'long'
          topo_key: "CodReg"
          tooltip_function: 'obsCovidRegicTooltip'
          topology:
            scope: "regic"
            range: "uf"
            id: 35 # default - São Paulo
          value_field: 'calc_deviation'
          colorScale:
            name: "RdYlGn"
            range:
              min_value: -1
              max_value: 1
        source:
          desc: "fonte"
          link: ""
# # ========================================================
#       - id: "topo_alta_complex_uti"
#         chart_type: "MAP_TOPOJSON"
#         title: 
#           fixed: "Leitos de UTI / 10.000 hab. - Situação nos Pólos de Atendimento de Alta Complexidade"
#         title_comment:
#           fixed: "Brasil, março 2020"
#         # info:
#         #   - type: "text"
#         #     title: "Sobre"
#         #     content:
#         #       fixed: ""
#         description:
#           # - type: "minicards"
#           #   cards:
#           #     - relevance: 'low'
#           #       cls: 'xs12 md6'
#           #       api: 
#           #         template: "/thematic/arranjoregic?categorias=qt_leitos_uti_arranjo&filtros=eq-cd_municipio_ibge_origem-{0}"
#           #         args:
#           #           - named_prop: "idLocalidadeD6"
#           #       args:
#           #         - prop: "value"
#           #           named_prop: 'qt_leitos_uti_arranjo'
#           #           format: 'inteiro'
#           #           default: "Sem Registros"
#           #           zero: "Nenhum"
#           #         - prop: "description"
#           #           fixed: 'Número de Leitos de UTI'
#           #     - relevance: 'low'
#           #       cls: 'xs12 md6'
#           #       api: 
#           #         template: "/thematic/arranjoregic?categorias=proporcao_leitos_uti_10k_arranjo&filtros=eq-cd_municipio_ibge_origem-{0}"
#           #         args:
#           #           - named_prop: "idLocalidadeD6"
#           #       args:
#           #         - prop: "value"
#           #           named_prop: 'proporcao_leitos_uti_10k_arranjo'
#           #           format: 'real'
#           #           default: "Sem Registros"
#           #           zero: "Nenhum"
#           #         - prop: "description"
#           #           fixed: 'Número de Leitos de UTI'
#           #         - prop: "comment"
#           #           fixed: 'por 10.000 hab.'
#           - type: "text"
#             title: ""
#             content:
#               fixed: "Texto..."
#           - id: "select_uf"
#             type: "select"
#             label: "Unidade Federativa"
#             clearable: false
#             default: 
#               fixed: 35 # São Paulo como default
#             target: 
#               range: "uf"
#               scope: "municipio"
#             api:
#               fixed: "/municipios?categorias=cd_uf,nm_uf&agregacao=distinct&ordenacao=nm_uf&filtros=eq-1-1"
#             args:
#               - prop: "id"
#                 named_prop: "cd_uf"
#               - prop: "label"
#                 named_prop: "nm_uf"
#             selection:
#               event: "selection"
#               rules:
#                 api: 
#                   template: "/thematic/arranjoregic?categorias=populacao_estimada_mun_origem,qt_leitos_uti_arranjo,proporcao_leitos_uti_10k_arranjo,nm_municipio_uf_origem-source_mun,nm_municipio_uf_alta_complex-target_mun,cd_municipio_ibge_dv_origem-cd_mun_ibge,cd_municipio_ibge_dv_alta_complex-target_cd_mun&agregacao=distinct&filtros=eq-cd_uf_origem-{0}"
#                   args:
#                     - named_prop: "cd_uf"
#         api: 
#           fixed: "/thematic/arranjoregic?categorias=populacao_estimada_mun_origem,qt_leitos_uti_arranjo,proporcao_leitos_uti_10k_arranjo,nm_municipio_uf_origem-source_mun,nm_municipio_uf_alta_complex-target_mun,cd_municipio_ibge_dv_origem-cd_mun_ibge,cd_municipio_ibge_dv_alta_complex-target_cd_mun&agregacao=distinct&filtros=eq-cd_uf_origem-35"
#           options:
#             calcs:
#               - id: 'uti_level'
#                 function: 'get_uti_level'
#                 fn_args:
#                   - named_prop: 'proporcao_leitos_uti_10k_arranjo'
#         headers:
#           - text: 'Município origem'
#             align: 'left'
#             value: 'source_mun'
#           - text: 'População estimada (2019)'
#             value: 'populacao_estimada_mun_origem'
#             format: 'inteiro'
#           - text: 'Pólo Destino para Atendimento de Alta Complexidade'
#             align: 'left'
#             value: 'target_mun'
#           - text: 'Qtd Leitos UTI no Pólo'
#             value: 'qt_leitos_uti_arranjo'
#             format: 'inteiro'
#           - text: 'Leitos UTI/10.000 hab. no Pólo'
#             value: 'proporcao_leitos_uti_10k_arranjo'
#             format: 'real'
#           - text: 'Situação no Pólo'
#             value: 'calc_uti_level'
#         chart_options:
#           id_field: 'cd_mun_ibge'
#           topo_key: "codarea"
#           value_field: 'calc_uti_level'
#           topology:
#             scope: 'municipio'
#             range: 'uf'
#             id: 35 # default - São Paulo
#           colorScale: 
#             type: "fixed"
#             color_array: 
#               "Abaixo do recomendado": "rgba(179, 9, 0, 0.7)"
#               "Dentro do recomendado": "#fbc11a"
#               "Acima do recomendado": "green"
#         source:
#           desc: "fonte"
#           link: ""
# ========================================================
      - id: "topo_alta_complex_uti2"
        chart_type: "MAP_TOPOJSON"
        title: 
          fixed: "Leitos de UTI / 10.000 hab. - Situação nos Pólos de Atendimento de Alta Complexidade"
        title_comment:
          template: "Brasil, em {0}/{1}"
          api: 
            fixed: "/thematic/arranjoregic?categorias=cnes_ano_refencia,cnes_mes_referencia&limit=1"
          args:
            - named_prop: "cnes_mes_referencia"
            - named_prop: "cnes_ano_refencia"
        # info:
        #   - type: "text"
        #     title: "Sobre"
        #     content:
        #       fixed: ""
        description:
          # - type: "minicards"
          #   cards:
          #     - relevance: 'low'
          #       cls: 'xs12 md6'
          #       api: 
          #         template: "/thematic/arranjoregic?categorias=qt_leitos_uti_arranjo&filtros=eq-cd_municipio_ibge_origem-{0}"
          #         args:
          #           - named_prop: "idLocalidadeD6"
          #       args:
          #         - prop: "value"
          #           named_prop: 'qt_leitos_uti_arranjo'
          #           format: 'inteiro'
          #           default: "Sem Registros"
          #           zero: "Nenhum"
          #         - prop: "description"
          #           fixed: 'Número de Leitos de UTI'
          #     - relevance: 'low'
          #       cls: 'xs12 md6'
          #       api: 
          #         template: "/thematic/arranjoregic?categorias=proporcao_leitos_uti_10k_arranjo&filtros=eq-cd_municipio_ibge_origem-{0}"
          #         args:
          #           - named_prop: "idLocalidadeD6"
          #       args:
          #         - prop: "value"
          #           named_prop: 'proporcao_leitos_uti_10k_arranjo'
          #           format: 'real'
          #           default: "Sem Registros"
          #           zero: "Nenhum"
          #         - prop: "description"
          #           fixed: 'Número de Leitos de UTI'
          #         - prop: "comment"
          #           fixed: 'por 10.000 hab.'
          - type: "text"
            title: ""
            content:
              fixed: "Texto..."
          - id: "select_uf"
            type: "select"
            label: "Unidade Federativa"
            clearable: false
            default: 
              fixed: 35 # São Paulo como default
            target: 
              range: "uf"
              scope: "municipio"
            api:
              fixed: "/municipios?categorias=cd_uf,nm_uf&agregacao=distinct&ordenacao=nm_uf&filtros=eq-1-1"
            args:
              - prop: "id"
                named_prop: "cd_uf"
              - prop: "label"
                named_prop: "nm_uf"
            selection:
              event: "selection"
              rules:
                api: 
                  template: "/thematic/arranjoregic?categorias=populacao_estimada_mun_origem,qt_leitos_uti_arranjo,proporcao_leitos_uti_10k_arranjo,nm_municipio_uf_origem-source_mun,nm_municipio_uf_alta_complex-target_mun,cd_municipio_ibge_dv_origem-cd_mun_ibge,cd_municipio_ibge_dv_alta_complex-target_cd_mun&agregacao=distinct&filtros=eq-cd_uf_origem-{0}"
                  args:
                    - named_prop: "cd_uf"
        api: 
          fixed: "/thematic/arranjoregic?categorias=populacao_estimada_mun_origem,qt_leitos_uti_arranjo,proporcao_leitos_uti_10k_arranjo,nm_municipio_uf_origem-source_mun,nm_municipio_uf_alta_complex-target_mun,cd_municipio_ibge_dv_origem-cd_mun_ibge,cd_municipio_ibge_dv_alta_complex-target_cd_mun&agregacao=distinct&filtros=eq-cd_uf_origem-35"
          options:
            recalc_min_max: true
            minmax_field: "proporcao_leitos_uti_10k_arranjo"
            calcs:
              - id: 'uti_level'
                function: 'get_uti_level'
                fn_args:
                  - named_prop: 'proporcao_leitos_uti_10k_arranjo'
              - id: "deviation_crescimento"
                function: "get_bipolar_scale"
                fn_args: 
                  - fixed: 'proporcao_leitos_uti_10k_arranjo'
                  - fixed: 2
        headers:
          - text: 'Município origem'
            align: 'left'
            value: 'source_mun'
          - text: 'População estimada (2019)'
            value: 'populacao_estimada_mun_origem'
            format: 'inteiro'
          - text: 'Pólo Destino para Atendimento de Alta Complexidade'
            align: 'left'
            value: 'target_mun'
          - text: 'Qtd Leitos UTI no Pólo'
            value: 'qt_leitos_uti_arranjo'
            format: 'inteiro'
          - text: 'Leitos UTI/10.000 hab. no Pólo'
            value: 'proporcao_leitos_uti_10k_arranjo'
            format: 'real'
          - text: 'Situação no Pólo'
            value: 'calc_uti_level'
        chart_options:
          id_field: 'cd_mun_ibge'
          topo_key: "codarea"
          value_field: 'calc_deviation_crescimento'
          topology:
            scope: 'municipio'
            range: 'uf'
            id: 35 # default - São Paulo
          colorScale:
            name: "RdYlGn"
            range:
              min_value: -1
              max_value: 1
        source:
          desc: "fonte"
          link: ""
# ===============================================
      - id: "prevalencia_priori_headline"
        type: "headline"
        title:
          fixed: "Áreas Prioritárias"
# ===============================================
      - id: "bar_priori_mun"
        type: "multiple-charts"
        title: 
          fixed: "Municípios - Maior número de casos"
        title_comment:
          template: "Brasil, {0}"
          api: 
            fixed: "/thematic/casoscovid19?categorias=1&valor=last_available_date&agregacao=MAX&filtros=eq-place_type-'state',and,eq-is_last-TRUE"
          args:
            - named_prop: "agr_max_last_available_date"
              format: 'dataDMY'
        # info:
        #   - type: "text"
        #     title: "Sobre a métrica"
        #     content:
        #       fixed: ""
        description:
          - type: "text"
            title: ""
            content:
              fixed: "Destacam-se, neste estudo, os municípios com o maior número de casos confirmados.<br/><br/>"
        charts:
          - id: "bar_priori_mun_casos"
            title: "Municípios com maior número de casos"
            cls: "xs12 md6"
            type: "BAR"
            api:
              fixed: "/thematic/casoscovid19?categorias=nm_municipio_uf,city_ibge_code,city,state,last_available_confirmed,last_available_deaths&valor=last_available_confirmed&agregacao=RANK_DENSE_SUM&filtros=eq-place_type-'city',and,eq-is_last-TRUE&limit=10"
              options:
                formatters:
                  - id: "last_available_confirmed"
                    format: 'inteiro'
                  - id: "last_available_deaths"
                    format: 'inteiro'
            headers:
              - text: 'Município'
                align: 'left'
                value: 'nm_municipio_uf'
              - text: 'Casos confirmados'
                value: 'fmt_last_available_confirmed'
              - text: 'Óbitos confirmados'
                value: 'fmt_last_available_deaths'
            options:
              id: "city_ibge_code"
              x: "agr_rank_dense_sum_last_available_confirmed"
              y: "last_available_confirmed"
              text: "nm_municipio_uf"
              hide_legend: true
              orientation: "vertical"
              show_x_axis: false
              show_y_axis: false
              color: "#238B45"
            source:
              desc: ""
              link: ""
          - id: "bar_priori_mun_óbitos"
            title: "Municípios com maior número de óbitos"
            cls: "xs12 md6"
            type: "BAR"
            api:
              fixed: "/thematic/casoscovid19?categorias=nm_municipio_uf,city_ibge_code,city,state,last_available_deaths,last_available_confirmed&valor=last_available_deaths&agregacao=RANK_DENSE_SUM&filtros=eq-place_type-'city',and,eq-is_last-TRUE&limit=10"
              options:
                formatters:
                  - id: "last_available_deaths"
                    format: 'inteiro'
                  - id: "last_available_confirmed"
                    format: 'inteiro'
            headers:
              - text: 'Município'
                align: 'left'
                value: 'nm_municipio_uf'
              - text: 'Óbitos confirmados'
                value: 'fmt_last_available_deaths'
              - text: 'Casos confirmados'
                value: 'fmt_last_available_confirmed'
            options:
              id: "city_ibge_code"
              x: "agr_rank_dense_sum_last_available_deaths"
              y: "last_available_deaths"
              text: "nm_municipio_uf"
              hide_legend: true
              orientation: "vertical"
              show_x_axis: false
              show_y_axis: false
              color: "#DA3736"
            source:
              desc: ""
              link: ""
